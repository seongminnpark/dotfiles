webpackJsonp([1],{0:function(module,exports,__webpack_require__){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{"default":obj}}function fetchInitialData(){return _bluebird2["default"].all([(0,_getUser2["default"])(),(0,_siteCache2["default"])(),(0,_cashbackActions.initCashback)()]).spread(function(resp,siteAPIData,cashback){resp&&(_state2["default"].set("session",_lodash2["default"].get(resp,"session")),_state2["default"].set("events",_lodash2["default"].get(resp,"settings.events")),_state2["default"].set("settings",_lodash2["default"].get(resp,"settings")),_state2["default"].set("couponsDisabledSites",_lodash2["default"].get(resp,"couponsDisabledSites")),_state2["default"].set("couponsAffiliateDisabledSites",_lodash2["default"].get(resp,"couponsAffiliateDisabledSites")),_state2["default"].set("pageViewId",window.__wb_page_view_id),_state2["default"].set("tabId",_lodash2["default"].get(resp,"tabId"))),_state2["default"].merge({siteAPIData:siteAPIData}),_state2["default"].merge({cashback:cashback})})}var _regenerator=__webpack_require__(57),_regenerator2=_interopRequireDefault(_regenerator),_stringify=__webpack_require__(478),_stringify2=_interopRequireDefault(_stringify),_asyncToGenerator2=__webpack_require__(84),_asyncToGenerator3=_interopRequireDefault(_asyncToGenerator2),_set=__webpack_require__(17),_set2=_interopRequireDefault(_set),init=function(){var _ref=(0,_asyncToGenerator3["default"])(_regenerator2["default"].mark(function _callee2(){var cashback,siteAPIData,initCoupons,domain,ogPageData,classifierFired,coupons,_this=this;return _regenerator2["default"].wrap(function(_context2){for(;;)switch(_context2.prev=_context2.next){case 0:return _context2.next=2,fetchInitialData();case 2:return(0,_getGoogleContacts2["default"])({contacts:!0}),cashback=_state2["default"].get("cashback"),_state2["default"].set("couponsVisible",!1),siteAPIData=_state2["default"].get("siteAPIData"),_context2.next=8,getInitCoupons(siteAPIData);case 8:initCoupons=_context2.sent,domain=(0,_currentDomain2["default"])(),"groupon.com"===domain&&(0,_sendMetric2["default"])("track","pushCouponScriptEnd",{pageViewId:_state2["default"].get("pageViewId")}),(0,_couponChecking2["default"])(domain),_state2["default"].get(["couponsDisabledSites",(0,_currentDomain2["default"])()+"_"+_state2["default"].get("tabId")])>(0,_moment2["default"])().unix()||(cashback&&!cashback.postCoupons?(0,_setBrowserAction2["default"])({active:!0,cashback:cashback}):(0,_setBrowserAction2["default"])({active:!0})),ogPageData=void 0;try{ogPageData=JSON.parse(sessionStorage.getItem("ogPageData"))}catch(e){}if(classifierFired=!1,_dewey2["default"].emitter.on("result",function(){var _ref2=(0,_asyncToGenerator3["default"])(_regenerator2["default"].mark(function _callee(result){var couponResult,ogCartTotal,newCartTotal,_domain,config,_config,res;return _regenerator2["default"].wrap(function(_context){for(;;)switch(_context.prev=_context.next){case 0:if("coupons_start"!==result.callSource||!result.pageData){_context.next=4;break}sessionStorage.setItem("ogPageData",(0,_stringify2["default"])(result.pageData)),_context.next=36;break;case 4:if("coupons_end"!==result.callSource){_context.next=20;break}couponResult=_state2["default"].select("couponView").get("resultTemp");try{ogPageData=JSON.parse(sessionStorage.getItem("ogPageData"))}catch(e){}sessionStorage.removeItem("ogPageData"),ogCartTotal=_lodash2["default"].get(ogPageData,"order.total"),newCartTotal=_lodash2["default"].get(result,"pageData.order.total"),couponResult.originalTotal=ogCartTotal||couponResult.originalTotal,couponResult.savings=ogCartTotal&&newCartTotal?ogCartTotal-newCartTotal:couponResult.savings,couponResult.savings>0&&(_lodash2["default"].get(result,"pageData.products.length")>1?result.pageData.products=_lodash2["default"].map(result.pageData.products,function(product,i){if(_lodash2["default"].has(product,"list_price")&&_lodash2["default"].has(ogPageData,"products["+i+"].list_price")){var productSavings=ogPageData.products[i].list_price-product.list_price;productSavings&&(product.coupon_savings=ogPageData.products[i].list_price-product.list_price)}return product.coupon_applied=couponResult.bestCoupon.code,product}):1===_lodash2["default"].get(result,"pageData.products.length")&&(result.pageData.products[0].coupon_savings=couponResult.savings,result.pageData.products[0].coupon_applied=couponResult.bestCoupon.code)),_domain=(0,_currentDomain2["default"])(),config=_state2["default"].get("couponsConfig"),config.pageWasReloaded?(config.result=couponResult,prepareCouponsApp(config,cashback)):_state2["default"].select("couponView").set("result",couponResult),(0,_sendMetric2["default"])("track","tryCouponsResult",{domain:_domain,clickId:couponResult.clickId,droppedCookie:couponResult.droppedCookie,originalTotal:couponResult.originalTotal,savings:couponResult.savings||0,errored:couponResult.errored,runTime:couponResult.runTime,totalCouponsTested:_lodash2["default"].get(couponResult,"coupons.length"),coupons:_lodash2["default"].get(couponResult,"coupons"),bestCoupon:_lodash2["default"].get(couponResult,"bestCoupon.code"),currentLocation:window.location}),(0,_sendMetric2["default"])("track","deweyResult",_lodash2["default"].assign(result,{url:window.location.href,domain:_domain})),_context.next=36;break;case 20:if(!ogPageData||!_lodash2["default"].get(result,"pageType")){_context.next=24;break}initCoupons(),_context.next=36;break;case 24:if(!CLASSIFIER_SITES.has(domain)||classifierFired){_context.next=36;break}if(!_lodash2["default"].get(result,"pageData")){_context.next=36;break}return classifierFired=!0,_context.next=29,initCoupons();case 29:if(_config=_context.sent,!_config){_context.next=36;break}return _context.next=33,(0,_fetchJSON2["default"])(_constants.ORIGIN_SITE_API+"/site/"+domain+"/coupon",{body:(0,_stringify2["default"])({pageData:result.pageData}),method:"POST"});case 33:res=_context.sent,_config.coupons=res.items,prepareCouponsApp(_config,cashback);case 36:case"end":return _context.stop()}},_callee,_this)}));return function(_x){return _ref2.apply(this,arguments)}}()),(0,_appLoaded.appLoaded)("coupons"),_context2.t0=!CLASSIFIER_SITES.has(domain)&&!ogPageData,!_context2.t0){_context2.next=23;break}return _context2.next=22,initCoupons();case 22:_context2.t0=_context2.sent;case 23:coupons=_context2.t0,coupons&&(coupons.pageWasReloaded||prepareCouponsApp(coupons,cashback));case 25:case"end":return _context2.stop()}},_callee2,this)}));return function(){return _ref.apply(this,arguments)}}(),prepareCouponsApp=function(){var _ref3=(0,_asyncToGenerator3["default"])(_regenerator2["default"].mark(function _callee3(coupons,cashback){var domain,viewData,isThrottled,seenThrottleToolTip,showThrottleToolTip,settings,showCoupons,loadOptions;return _regenerator2["default"].wrap(function(_context3){for(;;)switch(_context3.prev=_context3.next){case 0:return domain=(0,_currentDomain2["default"])(),_state2["default"].set("couponView",coupons),viewData=_state2["default"].get("cashbackView")||cashback,_state2["default"].set("cashbackView",viewData),_context3.next=6,(0,_couponsMessenger2["default"])({domain:domain,message:"isThrottled"});case 6:if(isThrottled=_context3.sent,seenThrottleToolTip=!!_state2["default"].get(["events","hasSeenCouponsThrottleToolTip"]),showThrottleToolTip=isThrottled&&!seenThrottleToolTip&&!coupons.pageWasReloaded,_state2["default"].select("couponView").set("showThrottleToolTip",showThrottleToolTip),settings=_state2["default"].get("settings"),showCoupons=!_lodash2["default"].has(settings,"notificationPreferences.showCouponCodes")||_lodash2["default"].get(settings,"notificationPreferences.showCouponCodes"),showCoupons&&!isThrottled||coupons.pageWasReloaded){_context3.next=17;break}if(_state2["default"].set("couponsThrottled",!0),showThrottleToolTip){_context3.next=17;break}return(0,_setBrowserAction2["default"])({active:!0,textOverride:_lodash2["default"].get(coupons,"coupons.length","")+"C"}),_context3.abrupt("return");case 17:loadOptions={initialRoute:"/coupons",cssUrl:"GENERATED/coupons.css",route:_react2["default"].createElement(_reactRouter.Route,{path:"coupons",component:_Coupon2["default"]}),disableDelay:!0},"groupon.com"===domain&&(0,_sendMetric2["default"])("track","foundCouponsEnd",{pageViewId:_state2["default"].get("pageViewId")}),_state2["default"].set("couponsVisible",!0),(0,_loadApp2["default"])(loadOptions);case 21:case"end":return _context3.stop()}},_callee3,this)}));return function(_x2,_x3){return _ref3.apply(this,arguments)}}(),getInitCoupons=function(){var _ref4=(0,_asyncToGenerator3["default"])(_regenerator2["default"].mark(function _callee4(siteAPIData){var domain,shopifyDomain,identifiers,deweyDoc,result,script;return _regenerator2["default"].wrap(function(_context4){for(;;)switch(_context4.prev=_context4.next){case 0:if(domain=_lodash2["default"].get(siteAPIData,"meta.domain"),(0,_currentDomain.setDomain)(domain),shopifyDomain=(0,_shopify2["default"])(domain),!_lodash2["default"].get(siteAPIData,"siteData.coupons.ignoreSite")){_context4.next=5;break}return _context4.abrupt("return",_lodash2["default"].noop);case 5:if(!("eeyore"===_lodash2["default"].get(siteAPIData,"siteData.coupons.type")&&_lodash2["default"].get(siteAPIData,"siteData.coupons.coupons.length")>0)){_context4.next=17;break}if(identifiers=_lodash2["default"].get(siteAPIData,"siteData.coupons.identifiers"),!identifiers){_context4.next=14;break}if(deweyDoc=document,deweyDoc.deweyParser=_jquery2["default"],deweyDoc.html=document.documentElement.innerHTML,result=_dewey2["default"].evaluateIdentifierTree(identifiers,deweyDoc),!result){_context4.next=14;break}return _context4.abrupt("return",_couponActions.initOnlyShowCoupons);case 14:return _context4.abrupt("return",_lodash2["default"].noop);case 17:if("tigger"!==_lodash2["default"].get(siteAPIData,"siteData.coupons.type")||!shopifyDomain&&!(0,_ivTigger.isTiggerSite)(domain)){_context4.next=32;break}if(!shopifyDomain){_context4.next=29;break}if((0,_currentDomain.setDomain)(shopifyDomain),shopifyDomain===domain){_context4.next=25;break}return _context4.next=23,(0,_fetchJSON2["default"])(_constants.SITE_API+"/coupons?tld="+shopifyDomain);case 23:script=_context4.sent,siteAPIData.siteData.coupons={coupons:script.items||[],ignoreSite:!!_lodash2["default"].isUndefined(script.ignoreSite)||script.ignoreSite,ignoreAffiliate:!!_lodash2["default"].isUndefined(script.ignoreAffiliate)||script.ignoreAffiliate,tld:script.tld};case 25:return siteAPIData.siteData.coupons.shopify=!0,siteAPIData.siteData.appliedCodeSelector=".applied-reduction-code__information",_context4.next=29,(0,_siteCache2["default"])(_lodash2["default"].assign(siteAPIData,{domain:shopifyDomain,setSite:!0}));case 29:return _context4.abrupt("return",_couponActions.initCoupons);case 32:if("roo"!==_lodash2["default"].get(siteAPIData,"siteData.coupons.type")){_context4.next=36;break}return _context4.abrupt("return",_rooActions.initCoupons);case 36:return _context4.abrupt("return",_lodash2["default"].noop);case 37:case"end":return _context4.stop()}},_callee4,this)}));return function(_x4){return _ref4.apply(this,arguments)}}(),_react=__webpack_require__(85),_react2=_interopRequireDefault(_react),_Coupon=__webpack_require__(637),_Coupon2=_interopRequireDefault(_Coupon),_reactRouter=__webpack_require__(317),_loadApp=__webpack_require__(375),_loadApp2=_interopRequireDefault(_loadApp),_getUser=__webpack_require__(636),_getUser2=_interopRequireDefault(_getUser),_getGoogleContacts=__webpack_require__(813),_getGoogleContacts2=_interopRequireDefault(_getGoogleContacts),_siteCache=__webpack_require__(475),_siteCache2=_interopRequireDefault(_siteCache),_setBrowserAction=__webpack_require__(185),_setBrowserAction2=_interopRequireDefault(_setBrowserAction),_couponsMessenger=__webpack_require__(777),_couponsMessenger2=_interopRequireDefault(_couponsMessenger),_couponActions=__webpack_require__(649),_rooActions=__webpack_require__(792),_cashbackActions=__webpack_require__(452),_currentDomain=__webpack_require__(429),_currentDomain2=_interopRequireDefault(_currentDomain),_couponChecking=__webpack_require__(838),_couponChecking2=_interopRequireDefault(_couponChecking),_shopify=__webpack_require__(840),_shopify2=_interopRequireDefault(_shopify),_fetchJSON=__webpack_require__(841),_fetchJSON2=_interopRequireDefault(_fetchJSON),_constants=__webpack_require__(193),_bluebird=__webpack_require__(148),_bluebird2=_interopRequireDefault(_bluebird),_state=__webpack_require__(141),_state2=_interopRequireDefault(_state),_lodash=__webpack_require__(143),_lodash2=_interopRequireDefault(_lodash),_moment=__webpack_require__(199),_moment2=_interopRequireDefault(_moment),_dewey=__webpack_require__(476),_dewey2=_interopRequireDefault(_dewey),_jquery=__webpack_require__(460),_jquery2=_interopRequireDefault(_jquery),_sendMetric=__webpack_require__(134),_sendMetric2=_interopRequireDefault(_sendMetric),_appLoaded=__webpack_require__(842),_ivTigger=__webpack_require__(651),CLASSIFIER_SITES=new _set2["default"](["etsy.com"]);"loading"!==document.readyState?init():document.addEventListener("DOMContentLoaded",init)},637:function(module,exports,__webpack_require__){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{"default":obj}}Object.defineProperty(exports,"__esModule",{value:!0});var _slicedToArray2=__webpack_require__(638),_slicedToArray3=_interopRequireDefault(_slicedToArray2),_regenerator=__webpack_require__(57),_regenerator2=_interopRequireDefault(_regenerator),_toConsumableArray2=__webpack_require__(645),_toConsumableArray3=_interopRequireDefault(_toConsumableArray2),_asyncToGenerator2=__webpack_require__(84),_asyncToGenerator3=_interopRequireDefault(_asyncToGenerator2),_getPrototypeOf=__webpack_require__(91),_getPrototypeOf2=_interopRequireDefault(_getPrototypeOf),_classCallCheck2=__webpack_require__(95),_classCallCheck3=_interopRequireDefault(_classCallCheck2),_createClass2=__webpack_require__(96),_createClass3=_interopRequireDefault(_createClass2),_possibleConstructorReturn2=__webpack_require__(99),_possibleConstructorReturn3=_interopRequireDefault(_possibleConstructorReturn2),_inherits2=__webpack_require__(101),_inherits3=_interopRequireDefault(_inherits2),_react=__webpack_require__(85),_react2=_interopRequireDefault(_react),_reactMotion=__webpack_require__(102),_baobab=__webpack_require__(121),_lodash=__webpack_require__(143),_lodash2=_interopRequireDefault(_lodash),_bluebird=__webpack_require__(148),_bluebird2=_interopRequireDefault(_bluebird),_couponActions=__webpack_require__(649),_rooActions=__webpack_require__(792),_cashbackActions=__webpack_require__(452),_CouponHeader=__webpack_require__(794),_CouponHeader2=_interopRequireDefault(_CouponHeader),_RenderResult=__webpack_require__(795),_RenderResult2=_interopRequireDefault(_RenderResult),_NoScript=__webpack_require__(833),_NoScript2=_interopRequireDefault(_NoScript),_Tooltip=__webpack_require__(463),_Tooltip2=_interopRequireDefault(_Tooltip),_hasFeature=__webpack_require__(374),_hasFeature2=_interopRequireDefault(_hasFeature),_sendMetric=__webpack_require__(134),_sendMetric2=_interopRequireDefault(_sendMetric),_currentDomain=__webpack_require__(429),_currentDomain2=_interopRequireDefault(_currentDomain);__webpack_require__(835),__webpack_require__(836),__webpack_require__(837);var Coupon=function(_Component){function Coupon(){var _ref;(0,_classCallCheck3["default"])(this,Coupon);for(var _len=arguments.length,args=Array(_len),_key=0;_key<_len;_key++)args[_key]=arguments[_key];var _this=(0,_possibleConstructorReturn3["default"])(this,(_ref=Coupon.__proto__||(0,_getPrototypeOf2["default"])(Coupon)).call.apply(_ref,[this].concat(args)));return _this.state={hideNotification:!0,viewCodes:!1,running:_this.props.view.rooRunning,rooRunning:_this.props.view.rooRunning,didTryCodes:_this.props.view.rooRunning||_this.props.view.pageWasReloaded||!1,result:_this.props.view.result,roo:_this.props.view.roo,showThrottleToolTip:_this.props.view.showThrottleToolTip,settings:_this.props.settings,ctaLoading:!1},_this}return(0,_inherits3["default"])(Coupon,_Component),(0,_createClass3["default"])(Coupon,[{key:"componentDidMount",value:function(){var _this2=this;(0,_sendMetric2["default"])("page","couponNotification",{view:"couponNotification",type:"notification",domain:(0,_currentDomain2["default"])(),pagePath:location.pathname}),setTimeout(function(){_this2.setState({hideNotification:!1})},200),this.boundCloseModal=this.closeModalOnClickOutside.bind(this),window.addEventListener("click",this.boundCloseModal)}},{key:"componentWillReceiveProps",value:function(nextProps){this.state.rooRunning&&this.props.view.rooRunning&&!nextProps.view.rooRunning&&(this.setState({running:!1}),this.setState({rooRunning:!1})),!this.state.didTryCodes&&nextProps.view.shouldTryCoupons&&(this.setState({hideNotification:!1}),this.onTryCodes()),nextProps.view.shouldDismissTooltip&&this.onDismissTooltip(),nextProps.view.result&&this.setState({result:nextProps.view.result}),nextProps.view.roo&&this.setState({roo:nextProps.view.roo}),_lodash2["default"].has(nextProps,"view.showThrottleToolTip")&&this.setState({showThrottleToolTip:nextProps.view.showThrottleToolTip}),_lodash2["default"].has(nextProps,"view.hideThrottleToolTip")&&this.setState({hideThrottleToolTip:nextProps.view.hideThrottleToolTip})}},{key:"render",value:function(){var _this3=this,_state=this.state,hideNotification=_state.hideNotification,roo=_state.roo,showOnTop=!0,showOnRight=!0,noScript=this.props.view.noScript,fullPageModal=this.shouldShowFullPage()?"full-page "+((0,_hasFeature2["default"])("coupon_invite_friends")?"":"invite-friends-full"):"",hideRight=("amazon.com"===(0,_currentDomain2["default"])()||"aliexpress.com"===(0,_currentDomain2["default"])())&&(this.state.running||_lodash2["default"].get(this.state.result,"pageReload")||this.state.barComplete),hideRightClass=hideRight?"hide-right":"";return this.state.showThrottleToolTip?_react2["default"].createElement("div",null,_react2["default"].createElement(_reactMotion.Motion,{style:{opacity:(0,_reactMotion.spring)(this.state.hideThrottleToolTip?0:1,{stiffness:180,damping:20})}},function(_ref2){var opacity=_ref2.opacity;return _react2["default"].createElement(_Tooltip2["default"],{tip:!0,tipLabel:"wikibuy tip:",message:_react2["default"].createElement("span",null,'click the green "w." above if you want to try codes again.'),style:{top:showOnTop?"15px":"auto",bottom:showOnTop?"auto":"15px",width:"461px",left:showOnRight?"auto":"15px",right:showOnRight?"15px":"auto"},innerStyle:{opacity:""+opacity},onDismissTooltip:_this3.onDismissTooltip.bind(_this3)})})):_react2["default"].createElement("div",{className:hideNotification?"disabled coupon-page "+hideRightClass+" "+(this.state.resetNotification?fullPageModal:""):"coupon-page "+hideRightClass+" "+fullPageModal,style:{top:showOnTop?"0":"auto",bottom:showOnTop?"auto":"0",left:showOnRight?"auto":"0",right:showOnRight?"0":"auto"}},_react2["default"].createElement(_reactMotion.Motion,{style:{opacity:(0,_reactMotion.spring)(hideNotification?0:1,{stiffness:180,damping:20}),y:(0,_reactMotion.spring)(hideNotification?showOnTop?-100:100:0,{stiffness:180,damping:20})}},function(_ref3){var opacity=_ref3.opacity,y=_ref3.y;return _react2["default"].createElement("div",{className:"coupon-notification",style:{transform:"translate3d(0,"+y+"%,0)",opacity:""+opacity}},_react2["default"].createElement(_CouponHeader2["default"],{view:_this3.props.view,running:_this3.state.running,roo:roo,fullPageModal:fullPageModal,onClosePopup:_this3.onClosePopup.bind(_this3)}),_react2["default"].createElement("section",null,noScript?_react2["default"].createElement(_NoScript2["default"],{view:_this3.props.view,reward:_lodash2["default"].get(_this3.props,"cashbackView.reward"),postCoupons:_lodash2["default"].get(_this3.props,"cashbackView.postCoupons")}):_react2["default"].createElement(_RenderResult2["default"],{hideRight:hideRight,googleData:_this3.props.googleData,domain:(0,_currentDomain2["default"])(),reward:_lodash2["default"].get(_this3.props,"cashbackView.reward"),postCoupons:_lodash2["default"].get(_this3.props,"cashbackView.postCoupons"),fullPageModal:fullPageModal,settings:_this3.state.settings,shortCode:_lodash2["default"].get(_this3.props,"session.short_code"),onTryCodes:_this3.onTryCodes.bind(_this3),onClosePopup:_this3.onClosePopup.bind(_this3),onToggleSubscribe:_this3.onToggleSubscribe.bind(_this3),getRunAnimation:_this3.getRunAnimation.bind(_this3),view:_this3.props.view,running:_this3.state.running,barComplete:_this3.state.barComplete,ctaLoading:_this3.state.ctaLoading})))}))}},{key:"shouldShowFullPage",value:function(){return!this.state.barComplete&&!this.state.running&&_lodash2["default"].get(this.state.result,"savings",0)>0&&(!this.state.qualified||this.state.qualified&&this.state.activated)||this.state.running||this.state.result}},{key:"onDismissTooltip",value:function(){var _this4=this;this.state.tooltipDismissed||(this.setState({hideThrottleToolTip:!0}),this.setState({hideNotification:!0}),this.setState({tooltipDismissed:!0}),(0,_cashbackActions.setSeenNotificationTooltip)("hasSeenCouponsThrottleToolTip"),setTimeout(function(){_this4.setState({showThrottleToolTip:!1})},1e3))}},{key:"onClosePopup",value:function(label){var _this5=this;this.setState({hideNotification:!0,resetNotification:!0},function(){_this5.timeout=setTimeout(function(){_this5.setState({resetNotification:!1})},1e3)}),this.state.rooRunning&&(0,_rooActions.cancelRoo)(),(0,_couponActions.throttleNotification)(),this.state.didTryCodes||(0,_sendMetric2["default"])("trackClick","dismissCouponNotification",label,{domain:(0,_currentDomain2["default"])(),pagePath:location.pathname})}},{key:"onToggleSubscribe",value:function(){function onToggleSubscribe(){return _ref4.apply(this,arguments)}var _ref4=(0,_asyncToGenerator3["default"])(_regenerator2["default"].mark(function _callee(){var currentD,subscriptions,subscribed,newSubscriptions,success,newSettings;return _regenerator2["default"].wrap(function(_context){for(;;)switch(_context.prev=_context.next){case 0:return currentD=(0,_currentDomain2["default"])(),subscriptions=this.state.settings.emailPreferences.coupons.domainSubscriptions,subscribed=_lodash2["default"].includes(subscriptions,currentD),newSubscriptions=void 0,subscribed?((0,_sendMetric2["default"])("track","couponSubscribe",{domain:(0,_currentDomain2["default"])(),pagePath:location.pathname,action:"unsubscribed"}),newSubscriptions=_lodash2["default"].reject(subscriptions,function(d){return d===currentD})):((0,_sendMetric2["default"])("track","couponSubscribe",{domain:(0,_currentDomain2["default"])(),pagePath:location.pathname,action:"subscribed"}),newSubscriptions=[].concat((0,_toConsumableArray3["default"])(subscriptions),[currentD])),this.setState({ctaLoading:!0}),_context.next=8,(0,_couponActions.updateEmailSubscriptions)(newSubscriptions);case 8:success=_context.sent,this.setState({ctaLoading:!1}),success&&(newSettings=_lodash2["default"].clone(this.state.settings),newSettings.emailPreferences.coupons.domainSubscriptions=newSubscriptions,this.setState({settings:newSettings}));case 11:case"end":return _context.stop()}},_callee,this)}));return onToggleSubscribe}()},{key:"onTryCodes",value:function(){function onTryCodes(){return _ref5.apply(this,arguments)}var _ref5=(0,_asyncToGenerator3["default"])(_regenerator2["default"].mark(function _callee2(){var tryCodes,runAnimation,reward,postCoupons,activateCredits,_this6=this;return _regenerator2["default"].wrap(function(_context2){for(;;)switch(_context2.prev=_context2.next){case 0:this.setState({didTryCodes:!0}),tryCodes=void 0,tryCodes=this.props.view.roo?_rooActions.tryCodes:_couponActions.tryCodes,runAnimation=this.getRunAnimation(),(0,_sendMetric2["default"])("trackClick","tryCodesButton","try codes",{domain:(0,_currentDomain2["default"])(),pagePath:location.pathname}),this.setState({running:!0}),this.setState({rooRunning:!!this.props.view.roo}),reward=_lodash2["default"].get(this.props.cashbackView,"reward"),postCoupons=_lodash2["default"].get(this.props.cashbackView,"postCoupons"),activateCredits=!1,reward&&reward.amount&&(!postCoupons||(0,_hasFeature2["default"])("cp_credits_with_coupon_saver")||(0,_hasFeature2["default"])("cp_credits_with_coupon_no_saver"))&&(activateCredits=!0),_bluebird2["default"].all([tryCodes({disableAffiliate:activateCredits||this.props.view.disableAffiliate}),activateCredits?(0,_cashbackActions.activateThroughPinnedTab)():_bluebird2["default"].resolve(),_bluebird2["default"].resolve().delay(runAnimation.duration)]).then(function(_ref6){var _ref7=(0,_slicedToArray3["default"])(_ref6,3),cashbackResp=(_ref7[0],_ref7[1]);_ref7[2];cashbackResp&&(0,_sendMetric2["default"])("track","activateCashbackRedirect",{domain:(0,_currentDomain2["default"])(),pagePath:location.pathname,rewardAmount:reward.amount,rewardDisplay:reward.type}),_this6.setState({running:!1,barComplete:!0,rooRunning:!1},function(){setTimeout(function(){return _this6.setState({barComplete:!1})},300)})});case 12:case"end":return _context2.stop()}},_callee2,this)}));return onTryCodes}()},{key:"getRunAnimation",value:function(){var _props$view=this.props.view,estimatedRunTime=_props$view.estimatedRunTime,roo=_props$view.roo,runAnimation=void 0;return roo?runAnimation={duration:0,stagger:0}:estimatedRunTime<=5e3?runAnimation={"class":"fast",stagger:500,duration:5500}:estimatedRunTime<=1e4?runAnimation={"class":"medium",stagger:1e3,duration:10500}:estimatedRunTime<=15e3?runAnimation={"class":"slow",stagger:1500,duration:15500}:estimatedRunTime<=2e4?runAnimation={"class":"extra-slow",stagger:2e3,duration:20500}:estimatedRunTime<=25e3&&(runAnimation={"class":"extra-extra-slow",stagger:2500,duration:25500}),runAnimation}},{key:"closeModalOnClickOutside",value:function(e){e.isTrusted&&this.state.result&&this.shouldShowFullPage()&&(_lodash2["default"].find(e.path,function(el){return"coupon-notification"===el.className})||this.onClosePopup())}},{key:"componentWillUnmount",value:function(){this.timeout&&clearTimeout(this.timeout),window.removeEventListener("click",this.boundCloseModal)}}]),Coupon}(_react.Component);exports["default"]=(0,_baobab.branch)({view:["couponView"],cashbackView:["cashbackView"],giftCardView:["giftCardView"],session:["session"],settings:["settings"],googleData:["googleData"]},Coupon)},638:function(module,exports,__webpack_require__){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{"default":obj}}exports.__esModule=!0;var _isIterable2=__webpack_require__(639),_isIterable3=_interopRequireDefault(_isIterable2),_getIterator2=__webpack_require__(642),_getIterator3=_interopRequireDefault(_getIterator2);exports["default"]=function(){function sliceIterator(arr,i){var _arr=[],_n=!0,_d=!1,_e=void 0;try{for(var _s,_i=(0,_getIterator3["default"])(arr);!(_n=(_s=_i.next()).done)&&(_arr.push(_s.value),!i||_arr.length!==i);_n=!0);}catch(err){_d=!0,_e=err}finally{try{!_n&&_i["return"]&&_i["return"]()}finally{if(_d)throw _e}}return _arr}return function(arr,i){if(Array.isArray(arr))return arr;if((0,_isIterable3["default"])(Object(arr)))return sliceIterator(arr,i);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}()},639:function(module,exports,__webpack_require__){module.exports={"default":__webpack_require__(640),__esModule:!0}},640:function(module,exports,__webpack_require__){__webpack_require__(36),__webpack_require__(20),module.exports=__webpack_require__(641)},641:function(module,exports,__webpack_require__){var classof=__webpack_require__(52),ITERATOR=__webpack_require__(33)("iterator"),Iterators=__webpack_require__(30);module.exports=__webpack_require__(7).isIterable=function(it){var O=Object(it);return void 0!==O[ITERATOR]||"@@iterator"in O||Iterators.hasOwnProperty(classof(O))}},792:function(module,exports,__webpack_require__){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{"default":obj}}function initCoupons(options){var _this=this;return new _promise2["default"](function(){var _ref4=(0,_asyncToGenerator3["default"])(_regenerator2["default"].mark(function _callee3(resolve,reject){var domain,siteAPIData,siteData,_siteData$coupons,script,coupons,ignoreAffiliate,isPage,config,nextAction,currentCouponCode,result,_result$store,droppedCookie,clickId;return _regenerator2["default"].wrap(function(_context3){for(;;)switch(_context3.prev=_context3.next){case 0:return domain=(0,_currentDomain2["default"])(),_context3.next=3,(0,_siteCache2["default"])(domain);case 3:return siteAPIData=_context3.sent,siteData={domain:domain,pageTypes:_lodash2["default"].get(siteAPIData,"siteData.pageTypes"),coupons:_lodash2["default"].get(siteAPIData,"siteData.coupons")},_siteData$coupons=siteData.coupons,script=_siteData$coupons.script,coupons=_siteData$coupons.coupons,ignoreAffiliate=_siteData$coupons.ignoreAffiliate,(ignoreAffiliate||_state2["default"].get(["couponsAffiliateDisabledSites",domain+"_"+_state2["default"].get("tabId")])>(0,_moment2["default"])().unix())&&cursor.set("disableAffiliate",!0),_context3.next=9,(0,_roo.isCouponPage)(siteData.coupons.script);case 9:if(isPage=_context3.sent){_context3.next=12;break}return _context3.abrupt("return");case 12:if(!(_state2["default"].get(["couponsDisabledSites",domain+"_"+_state2["default"].get("tabId")])>(0,_moment2["default"])().unix())){_context3.next=14;break}return _context3.abrupt("return");case 14:return config={coupons:coupons,roo:!0,estimatedRunTime:25e3,runTimePerCoupon:(script.getTotalDelay||0)+(script.preApplyDelay||0)+(script.postRemoveDelay||0),couponCount:coupons.length,disableAffiliate:ignoreAffiliate||(0,_hasFeature2["default"])("ext_tigger_af_off")},(0,_hasFeature2["default"])("user_contributed_codes")&&setupCouponListener(script),_context3.next=18,(0,_rooPouch2["default"])({action:"pageLoad"});case 18:return _context3.next=20,(0,_rooPouch2["default"])({action:"next"});case 20:if(nextAction=_context3.sent,!nextAction){_context3.next=40;break}if(tryingCodes=!0,"cancelled"!==nextAction.action){_context3.next=27;break}return _context3.abrupt("return");case 27:return _context3.next=29,(0,_rooPouch2["default"])({action:"nextCode"});case 29:return currentCouponCode=_context3.sent,_lodash2["default"].assign(config,{disableDelay:!!currentCouponCode,rooRunning:!0,currentCouponCode:currentCouponCode}),_state2["default"].set("couponsConfig",config),resolve(config),_context3.next=35,rooRunner(nextAction,{onTryCode:onTryCode});case 35:result=_context3.sent,result&&(_result$store=result.store,droppedCookie=_result$store.droppedCookie,clickId=_result$store.clickId,result.duration=result.runTime,(0,_couponActions.handleResult)({result:result,droppedCookie:droppedCookie,clickId:clickId})),cursor.set("rooRunning",!1);case 38:_context3.next=43;break;case 40:(0,_sendMetric2["default"])("track","couponCheck",{domain:domain,pagePath:location.pathname}),_state2["default"].set("couponsConfig",config),resolve(config);case 43:case"end":return _context3.stop()}},_callee3,_this)}));return function(_x2,_x3){return _ref4.apply(this,arguments)}}())}Object.defineProperty(exports,"__esModule",{value:!0}),exports.tryCodes=exports.cancelRoo=void 0;var _promise=__webpack_require__(73),_promise2=_interopRequireDefault(_promise),_regenerator=__webpack_require__(57),_regenerator2=_interopRequireDefault(_regenerator),_asyncToGenerator2=__webpack_require__(84),_asyncToGenerator3=_interopRequireDefault(_asyncToGenerator2),rooRunner=(exports.cancelRoo=function(){var _ref=(0,_asyncToGenerator3["default"])(_regenerator2["default"].mark(function _callee(){return _regenerator2["default"].wrap(function(_context){for(;;)switch(_context.prev=_context.next){case 0:return(0,_sendMetric2["default"])("track","rooCancelled",{domain:(0,_currentDomain2["default"])(),url:document.URL}),_context.next=3,(0,_rooPouch2["default"])({action:"cancel"});case 3:tryingCodes=!1;case 4:case"end":return _context.stop()}},_callee,this);
}));return function(){return _ref.apply(this,arguments)}}(),exports.tryCodes=function(){var _ref2=(0,_asyncToGenerator3["default"])(_regenerator2["default"].mark(function _callee2(_ref3){var clickId,domain,droppedCookie,siteAPIData,couponStartTime,next,result,disableAffiliate=_ref3.disableAffiliate;return _regenerator2["default"].wrap(function(_context2){for(;;)switch(_context2.prev=_context2.next){case 0:return tryingCodes=!0,clickId=_nodeUuid2["default"].v4().replace(/-/g,""),domain=(0,_currentDomain2["default"])(),droppedCookie=!disableAffiliate,disableAffiliate||(0,_couponActions.dropCookie)(clickId),(0,_sendMetric2["default"])("track","tryCoupons",{domain:domain,clickId:clickId,droppedCookie:droppedCookie,currentLocation:window.location}),_context2.next=8,(0,_siteCache2["default"])(domain);case 8:return siteAPIData=_context2.sent,_dewey2["default"].run({callSource:"coupons_start"}),couponStartTime=(new Date).getTime(),_context2.next=13,(0,_rooPouch2["default"])({action:"init",coupons:cursor.get("coupons"),script:_lodash2["default"].get(siteAPIData,"siteData.coupons.script"),store:{droppedCookie:droppedCookie,clickId:clickId}});case 13:return _context2.next=15,(0,_rooPouch2["default"])({action:"next"});case 15:if(next=_context2.sent){_context2.next=18;break}return _context2.abrupt("return");case 18:return _context2.next=20,rooRunner(next,{onTryCode:onTryCode});case 20:result=_context2.sent,result&&(result.duration=(new Date).getTime()-couponStartTime,(0,_couponActions.handleResult)({result:result,droppedCookie:droppedCookie,clickId:clickId})),tryingCodes=!1;case 23:case"end":return _context2.stop()}},_callee2,this)}));return function(_x){return _ref2.apply(this,arguments)}}(),function(){var _ref5=(0,_asyncToGenerator3["default"])(_regenerator2["default"].mark(function _callee4(message,cbs){var _cbs$onTryCode,onTryCode,coupon,total,removed,next,stack,_message;return _regenerator2["default"].wrap(function(_context4){for(;;)switch(_context4.prev=_context4.next){case 0:if(_cbs$onTryCode=cbs.onTryCode,onTryCode=void 0===_cbs$onTryCode?null:_cbs$onTryCode,tryingCodes=!0,_context4.prev=2,"tryCode"!==message.action){_context4.next=12;break}return onTryCode&&!message.applyingBestCode&&onTryCode(message.code),_context4.next=7,(0,_roo.applyCode)(message.script,message.code);case 7:return coupon=_context4.sent,_context4.next=10,(0,_rooPouch2["default"])({action:"saveCoupon",coupon:coupon});case 10:_context4.next=48;break;case 12:if("getTotal"!==message.action){_context4.next=20;break}return _context4.next=15,(0,_roo.getTotal)(message.script);case 15:return total=_context4.sent,_context4.next=18,(0,_rooPouch2["default"])({action:"saveTotal",total:total});case 18:_context4.next=48;break;case 20:if("removePrevious"!==message.action){_context4.next=28;break}return _context4.next=23,(0,_roo.removePrevious)(message.script,message.lastCodeHadSavings);case 23:return removed=_context4.sent,_context4.next=26,(0,_rooPouch2["default"])({action:"codeRemoved",removed:removed});case 26:_context4.next=48;break;case 28:if("finish"!==message.action){_context4.next=33;break}return tryingCodes=!1,_context4.abrupt("return",message.result);case 33:if("error"!==message.action){_context4.next=38;break}throw tryingCodes=!1,new Error(message.error.message);case 38:if("cancelled"!==message.action){_context4.next=43;break}return tryingCodes=!1,_context4.abrupt("return");case 43:if("wait"!==message.action){_context4.next=48;break}return _context4.next=46,(0,_delay2["default"])(1e4);case 46:return _context4.next=48,(0,_rooPouch2["default"])({action:"pageLoad"});case 48:return _context4.next=50,(0,_rooPouch2["default"])({action:"next"});case 50:if(next=_context4.sent){_context4.next=53;break}return _context4.abrupt("return");case 53:return _context4.next=55,rooRunner(next,cbs);case 55:return _context4.abrupt("return",_context4.sent);case 58:return _context4.prev=58,_context4.t0=_context4["catch"](2),stack=_context4.t0.stack.split("\n"),_message=(stack[0]+stack[1]).match(/(.*)\s\(/)[1],(0,_sendMetric2["default"])("track","rooError",{message:_message,domain:(0,_currentDomain2["default"])(),url:document.URL}),_context4.next=65,(0,_rooPouch2["default"])({action:"error"});case 65:return _context4.abrupt("return",_context4.sent);case 66:case"end":return _context4.stop()}},_callee4,this,[[2,58]])}));return function(_x4,_x5){return _ref5.apply(this,arguments)}}()),setupCouponListener=function(){var _ref6=(0,_asyncToGenerator3["default"])(_regenerator2["default"].mark(function _callee5(script){var promoApplyElement;return _regenerator2["default"].wrap(function(_context5){for(;;)switch(_context5.prev=_context5.next){case 0:try{script.promoApplyAction&&(promoApplyElement=(0,_roo.getElement)(script.promoApplyAction),promoApplyElement&&promoApplyElement.addEventListener("click",function(e){if(!tryingCodes){var promoInputEl=(0,_roo.getPromoCodeEl)(script);if(promoInputEl){var code=promoInputEl.value;if(_lodash2["default"].get(code,"length")){var domain=(0,_currentDomain2["default"])();(0,_sendMetric2["default"])("track","userContributedCode",{domain:domain,pagePath:location.pathname,code:code})}}}}))}catch(e){}case 1:case"end":return _context5.stop()}},_callee5,this)}));return function(_x6){return _ref6.apply(this,arguments)}}();exports.initCoupons=initCoupons;var _roo=__webpack_require__(779),_state=__webpack_require__(141),_state2=_interopRequireDefault(_state),_sendMetric=__webpack_require__(134),_sendMetric2=_interopRequireDefault(_sendMetric),_nodeUuid=__webpack_require__(389),_nodeUuid2=_interopRequireDefault(_nodeUuid),_lodash=__webpack_require__(143),_lodash2=_interopRequireDefault(_lodash),_hasFeature=__webpack_require__(374),_hasFeature2=_interopRequireDefault(_hasFeature),_currentDomain=__webpack_require__(429),_currentDomain2=_interopRequireDefault(_currentDomain),_siteCache=__webpack_require__(475),_siteCache2=_interopRequireDefault(_siteCache),_rooPouch=__webpack_require__(793),_rooPouch2=_interopRequireDefault(_rooPouch),_moment=__webpack_require__(199),_moment2=_interopRequireDefault(_moment),_couponActions=__webpack_require__(649),_delay=__webpack_require__(780),_delay2=_interopRequireDefault(_delay),_dewey=__webpack_require__(476),_dewey2=_interopRequireDefault(_dewey),tryingCodes=!1,cursor=_state2["default"].select("couponView"),onTryCode=function(code){return cursor.set("currentCouponCode",code)}},793:function(module,exports,__webpack_require__){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{"default":obj}}Object.defineProperty(exports,"__esModule",{value:!0});var _messenger=__webpack_require__(135),_messenger2=_interopRequireDefault(_messenger);exports["default"]=function(data){return(0,_messenger2["default"])("rooPouch",data)}},794:function(module,exports,__webpack_require__){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{"default":obj}}Object.defineProperty(exports,"__esModule",{value:!0});var _getPrototypeOf=__webpack_require__(91),_getPrototypeOf2=_interopRequireDefault(_getPrototypeOf),_classCallCheck2=__webpack_require__(95),_classCallCheck3=_interopRequireDefault(_classCallCheck2),_createClass2=__webpack_require__(96),_createClass3=_interopRequireDefault(_createClass2),_possibleConstructorReturn2=__webpack_require__(99),_possibleConstructorReturn3=_interopRequireDefault(_possibleConstructorReturn2),_inherits2=__webpack_require__(101),_inherits3=_interopRequireDefault(_inherits2),_react=__webpack_require__(85),_react2=_interopRequireDefault(_react),CouponHeader=function(_Component){function CouponHeader(){return(0,_classCallCheck3["default"])(this,CouponHeader),(0,_possibleConstructorReturn3["default"])(this,(CouponHeader.__proto__||(0,_getPrototypeOf2["default"])(CouponHeader)).apply(this,arguments))}return(0,_inherits3["default"])(CouponHeader,_Component),(0,_createClass3["default"])(CouponHeader,[{key:"render",value:function(){var _props=this.props,running=_props.running,fullPageModal=(_props.view,_props.fullPageModal),roo=_props.roo;return _react2["default"].createElement("header",null,_react2["default"].createElement("div",{className:"w-icon-logo"},this.renderWIcon()),_react2["default"].createElement("div",{className:"group"},roo||!running||fullPageModal?_react2["default"].createElement("div",{className:"close icon-x",onClick:this.props.onClosePopup.bind(this,"x")}):null))}},{key:"renderWIcon",value:function(){return _react2["default"].createElement("svg",{id:"Layer_1",x:"0px",y:"0px",viewBox:"0 0 60 45"},_react2["default"].createElement("g",null,_react2["default"].createElement("path",{d:"M39.4,35.9h-9L25,19.1h-0.1l-5.2,16.8h-9L1.3,8.8h9.6L15.7,26h0.1l4.9-17.2h8.9l5,17.2h0.1l4.8-17.2h9.3 L39.4,35.9z M57.7,31.6c0,0.7-0.1,1.4-0.4,2c-0.2,0.6-0.6,1.1-1,1.6c-0.4,0.4-1,0.8-1.7,1s-1.3,0.3-2,0.3c-1.5,0-2.7-0.5-3.7-1.4 c-1-0.9-1.4-2-1.4-3.5c0-0.7,0.1-1.3,0.4-1.8c0.2-0.7,0.6-1.3,1-1.6c0.8-0.7,1.4-1,1.7-1.1c0.9-0.3,1.6-0.4,2-0.4 c0.7,0,1.4,0.1,2,0.4c0.7,0.2,1.2,0.6,1.7,1c0.3,0.3,0.7,0.8,1.1,1.6C57.6,30.2,57.7,30.8,57.7,31.6z"})))}}]),CouponHeader}(_react.Component);exports["default"]=CouponHeader},795:function(module,exports,__webpack_require__){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{"default":obj}}Object.defineProperty(exports,"__esModule",{value:!0});var _extends2=__webpack_require__(1),_extends3=_interopRequireDefault(_extends2),_getPrototypeOf=__webpack_require__(91),_getPrototypeOf2=_interopRequireDefault(_getPrototypeOf),_classCallCheck2=__webpack_require__(95),_classCallCheck3=_interopRequireDefault(_classCallCheck2),_createClass2=__webpack_require__(96),_createClass3=_interopRequireDefault(_createClass2),_possibleConstructorReturn2=__webpack_require__(99),_possibleConstructorReturn3=_interopRequireDefault(_possibleConstructorReturn2),_inherits2=__webpack_require__(101),_inherits3=_interopRequireDefault(_inherits2),_react=__webpack_require__(85),_react2=_interopRequireDefault(_react),_lodash=__webpack_require__(143),_lodash2=_interopRequireDefault(_lodash),_sendMetric=__webpack_require__(134),_sendMetric2=_interopRequireDefault(_sendMetric),_NoSavingsAvailable=__webpack_require__(796),_NoSavingsAvailable2=_interopRequireDefault(_NoSavingsAvailable),_ReviewWikibuy=__webpack_require__(799),_ReviewWikibuy2=_interopRequireDefault(_ReviewWikibuy),_InviteFriends=__webpack_require__(801),_InviteTest=(_interopRequireDefault(_InviteFriends),__webpack_require__(814)),_InviteTest2=_interopRequireDefault(_InviteTest),_CallToAction=__webpack_require__(820),_CallToAction2=_interopRequireDefault(_CallToAction),_SavingsAvailable=__webpack_require__(822),_SavingsAvailable2=_interopRequireDefault(_SavingsAvailable),_CouponListForRunning=__webpack_require__(824),_CouponListForRunning2=_interopRequireDefault(_CouponListForRunning),_currency=__webpack_require__(815),_currency2=_interopRequireDefault(_currency),_ProgressBar=__webpack_require__(829),_ProgressBar2=_interopRequireDefault(_ProgressBar),_RooProgressBar=__webpack_require__(831),_RooProgressBar2=_interopRequireDefault(_RooProgressBar),_hasFeature=__webpack_require__(374),_hasFeature2=_interopRequireDefault(_hasFeature),_couponActions=__webpack_require__(649),RenderResult=function(_Component){function RenderResult(){var _ref;(0,_classCallCheck3["default"])(this,RenderResult);for(var _len=arguments.length,args=Array(_len),_key=0;_key<_len;_key++)args[_key]=arguments[_key];var _this=(0,_possibleConstructorReturn3["default"])(this,(_ref=RenderResult.__proto__||(0,_getPrototypeOf2["default"])(RenderResult)).call.apply(_ref,[this].concat(args)));return _this.state={viewCodes:!1},_this}return(0,_inherits3["default"])(RenderResult,_Component),(0,_createClass3["default"])(RenderResult,[{key:"render",value:function(){var _props$view=this.props.view,coupons=_props$view.coupons,result=_props$view.result,couponCount=_props$view.couponCount,pageWasReloaded=_props$view.pageWasReloaded,estimatedRunTime=_props$view.estimatedRunTime,currentCouponCode=_props$view.currentCouponCode,runTimePerCoupon=_props$view.runTimePerCoupon,roo=_props$view.roo,_props=this.props,running=_props.running,barComplete=_props.barComplete,reward=_props.reward,postCoupons=_props.postCoupons,pageReload=_lodash2["default"].get(result,"pageReload"),originalTotal=_lodash2["default"].get(result,"originalTotal"),workingCoupons=_lodash2["default"].filter(_lodash2["default"].get(result,"coupons"),function(c){return c.savings>0}),savings=result&&result.savings&&result.savings>0?(0,_currency2["default"])(result.savings):0,bestCode=_lodash2["default"].get(result,"bestCoupon.code"),runTimeSeconds=(_lodash2["default"].get(result,"runTime",0)/1e3).toFixed(2),resultCoupons=(0,_lodash2["default"])(coupons).take(couponCount).map(function(coupon,i){return coupon.success=!0,coupon}).value(),currentCodeIndex=void 0;roo&&!result&&(currentCodeIndex=_lodash2["default"].findIndex(resultCoupons,function(coupon){return coupon.code===currentCouponCode}),resultCoupons=_lodash2["default"].map(resultCoupons,function(coupon,i){return i<currentCodeIndex?coupon.success=!0:coupon.success=!1,coupon}));var runAnimation=this.props.getRunAnimation(),showProgressBar=running||pageReload||barComplete,noSavingsAvailable=result&&(!bestCode||!savings)&&!running,renderPostResultCtaInUi=!barComplete&&!running&&result,inviteFriends=(0,_hasFeature2["default"])("notif_invite_friends")||(0,_hasFeature2["default"])("notif_invite_friends_link"),requiresInput=((0,_hasFeature2["default"])("referral_get5")||(0,_hasFeature2["default"])("referral_get5_go")||(0,_hasFeature2["default"])("referral_get5_links"),result&&result.requiresInput),hideRight=this.props.hideRight;return _react2["default"].createElement("div",{className:"render-result-layout invite-test-layout"},_react2["default"].createElement("div",{className:"left"},_react2["default"].createElement("div",{className:"result-column "+(_lodash2["default"].get(this.props.googleData,"contacts.length")?"has-contacts":"")},showProgressBar?_react2["default"].createElement("div",{className:"try-codes-wrapper"},_react2["default"].createElement("div",null,_react2["default"].createElement("h2",null,"Trying Coupon Codes"),_react2["default"].createElement("h5",{className:"silver"},"Wikibuy automatically tries the best coupon codes to save you money."),_react2["default"].createElement("div",{className:"progress-bar"},roo?_react2["default"].createElement(_RooProgressBar2["default"],{estimatedDuration:estimatedRunTime,complete:barComplete,currentCodeIndex:currentCodeIndex,coupons:coupons,runTimePerCoupon:runTimePerCoupon}):_react2["default"].createElement(_ProgressBar2["default"],{estimatedDuration:estimatedRunTime,complete:barComplete})),currentCodeIndex>-1?_react2["default"].createElement("h5",{style:{textAlign:"center",marginTop:15},className:"bold"},"Trying ",currentCodeIndex+1," of ",couponCount," Codes"):_react2["default"].createElement("h5",{style:{height:"20px"}}))):!running&&!result||running||pageReload||barComplete?_react2["default"].createElement("div",null,_react2["default"].createElement("div",null,_react2["default"].createElement("h2",null,_react2["default"].createElement("span",null,"Found ",couponCount," ",1===couponCount?"code":"codes"),reward&&reward.amount&&(!postCoupons||(0,_hasFeature2["default"])("cp_credits_with_coupon_saver")||(0,_hasFeature2["default"])("cp_credits_with_coupon_no_saver"))?_react2["default"].createElement("span",null," and ",_react2["default"].createElement("br",null),"get ",_react2["default"].createElement("span",{className:"palmetto"},"percentage"===reward.type?reward.amount/100+"% back":"$"+reward.amount/100+" in credit")):null),_react2["default"].createElement("h4",{className:"bold"},"Wikibuy tests codes in seconds."))):noSavingsAvailable?_react2["default"].createElement(_NoSavingsAvailable2["default"],(0,_extends3["default"])({runTimeSeconds:runTimeSeconds,couponCount:couponCount,roo:roo,reward:reward,postCoupons:postCoupons,requiresInput:requiresInput},{codes:_lodash2["default"].get(result,"coupons"),onClosePopup:this.props.onClosePopup.bind(this)})):_react2["default"].createElement(_SavingsAvailable2["default"],(0,_extends3["default"])({runTimeSeconds:runTimeSeconds,couponCount:couponCount,savings:savings,reward:reward,postCoupons:postCoupons,originalTotal:originalTotal,workingCoupons:workingCoupons,requiresInput:requiresInput},{onClosePopup:this.props.onClosePopup.bind(this)})),_react2["default"].createElement(_CallToAction2["default"],(0,_extends3["default"])({domain:this.props.domain,onTryCodes:this.props.onTryCodes.bind(this),onClosePopup:this.props.onClosePopup.bind(this),onToggleSubscribe:this.props.onToggleSubscribe.bind(this),renderViewCodes:this.renderViewCodes.bind(this),renderPostResultCtaInUi:renderPostResultCtaInUi,loading:this.props.ctaLoading,settings:this.props.settings,roo:roo},{running:running,result:result,couponCount:couponCount,pageReload:pageReload,savings:savings})))),hideRight?null:_react2["default"].createElement("div",{className:"right"},showProgressBar?_react2["default"].createElement("div",{className:"run-codes"},_react2["default"].createElement(_CouponListForRunning2["default"],{runTimePerCoupon:runTimePerCoupon,currentCodeIndex:currentCodeIndex,estimatedRunTime:estimatedRunTime,disableChecks:!0,show:running||result,result:result,running:running,coupons:resultCoupons,stagger:pageWasReloaded?0:runAnimation.stagger,collapsable:!0})):null,renderPostResultCtaInUi&&!inviteFriends?_react2["default"].createElement(_ReviewWikibuy2["default"],{onClosePopup:this.props.onClosePopup.bind(this),savings:_lodash2["default"].get(this.props,"view.savings",0)}):renderPostResultCtaInUi?_react2["default"].createElement(_InviteTest2["default"],{googleContacts:this.props.googleData,firstname:_lodash2["default"].get(this.props,"settings.firstname",null),lastname:_lodash2["default"].get(this.props,"settings.lastname",null),shortCode:this.props.shortCode,onClosePopup:this.props.onClosePopup.bind(this)}):null))}},{key:"onTryCodes",value:function(skippedSignup){this.setState({viewCodes:!1}),this.props.onTryCodes(skippedSignup)}},{key:"renderViewCodes",value:function(){var _props$view2=this.props.view,coupons=_props$view2.coupons,result=_props$view2.result,couponCount=_props$view2.couponCount,resultCoupons=result?coupons.slice(couponCount,coupons.length):coupons;return resultCoupons&&resultCoupons.length>0?_react2["default"].createElement("div",null,_react2["default"].createElement("h4",{className:"bold",style:{marginBottom:"8px",marginTop:"8px",textAlign:"center"}},_react2["default"].createElement("span",{className:"tertiary-link",onClick:this.onClickViewCode.bind(this)},this.state.viewCodes?"hide codes":"view codes")),_react2["default"].createElement(CouponList,{running:running,show:!!this.state.viewCodes,coupons:resultCoupons,collapsable:!0,result:result,disableChecks:!0})):null}},{key:"onClickViewCode",value:function(){(0,_sendMetric2["default"])("trackClick","toggleCodes",this.state.viewCodes?"hide codes":"view codes",{domain:this.props.domain,pagePath:location.pathname}),this.state.viewCodes||(0,_couponActions.viewAllCodes)(),this.setState({viewCodes:!this.state.viewCodes})}}]),RenderResult}(_react.Component);exports["default"]=RenderResult},796:function(module,exports,__webpack_require__){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{"default":obj}}Object.defineProperty(exports,"__esModule",{value:!0});var _getPrototypeOf=__webpack_require__(91),_getPrototypeOf2=_interopRequireDefault(_getPrototypeOf),_classCallCheck2=__webpack_require__(95),_classCallCheck3=_interopRequireDefault(_classCallCheck2),_createClass2=__webpack_require__(96),_createClass3=_interopRequireDefault(_createClass2),_possibleConstructorReturn2=__webpack_require__(99),_possibleConstructorReturn3=_interopRequireDefault(_possibleConstructorReturn2),_inherits2=__webpack_require__(101),_inherits3=_interopRequireDefault(_inherits2),_react=__webpack_require__(85),_react2=_interopRequireDefault(_react),_copyToClip=__webpack_require__(797),_copyToClip2=_interopRequireDefault(_copyToClip),_sendMetric=__webpack_require__(134),_sendMetric2=_interopRequireDefault(_sendMetric),_hasFeature=__webpack_require__(374),_hasFeature2=_interopRequireDefault(_hasFeature),_cashbackActions=__webpack_require__(452),_lodash=__webpack_require__(143),_lodash2=_interopRequireDefault(_lodash);__webpack_require__(798);var NoSavingsAvailable=function(_Component){function NoSavingsAvailable(){var _ref;(0,_classCallCheck3["default"])(this,NoSavingsAvailable);for(var _len=arguments.length,args=Array(_len),_key=0;_key<_len;_key++)args[_key]=arguments[_key];var _this=(0,_possibleConstructorReturn3["default"])(this,(_ref=NoSavingsAvailable.__proto__||(0,_getPrototypeOf2["default"])(NoSavingsAvailable)).call.apply(_ref,[this].concat(args)));return _this.state={viewCodes:!1},_this}return(0,_inherits3["default"])(NoSavingsAvailable,_Component),(0,_createClass3["default"])(NoSavingsAvailable,[{key:"componentDidMount",value:function(){var reward=this.props.reward;reward&&reward.amount&&((0,_hasFeature2["default"])("cp_credits_after_coupon_saver")||(0,_hasFeature2["default"])("cp_credits_after_coupon_no_saver"))&&(0,_cashbackActions.activateThroughPinnedTab)()}},{key:"render",value:function(){var _this2=this,_props=this.props,runTimeSeconds=_props.runTimeSeconds,couponCount=_props.couponCount,reward=_props.reward,postCoupons=_props.postCoupons,codes=_props.codes,requiresInput=_props.requiresInput,rewardFound=reward&&reward.amount&&(!postCoupons||!(0,_hasFeature2["default"])("cp_credits_control"));return _react2["default"].createElement("div",{className:"no-savings-wrapper"},_react2["default"].createElement("div",{className:"no-savings-header"},requiresInput?_react2["default"].createElement("h2",null,"Code Entered"):rewardFound?_react2["default"].createElement("h2",null,"Credit Activated"):_react2["default"].createElement("h2",null,"No Savings Available."),codes.length?_react2["default"].createElement("div",{className:"view-codes-link-wrapper"},_react2["default"].createElement("h6",{onClick:rewardFound?function(){return _this2.setState({viewCodes:!_this2.state.viewCodes})}:null,className:(rewardFound?"clickable":"")+' bold"'},this.state.viewCodes?_react2["default"].createElement("span",null,"hide codes"):_react2["default"].createElement("span",null,couponCount," ",1===couponCount?" code ":" best codes "," tested in ",runTimeSeconds," sec."))):null),this.state.viewCodes||!rewardFound?_react2["default"].createElement("div",{className:"view-codes"},_lodash2["default"].map(codes,function(wc,i){var copied=_this2.state.copied===wc.code;return _react2["default"].createElement("div",{onClick:_this2.onClickCopy.bind(_this2,wc.code),key:i,style:{animationDelay:50*(i+1)+"ms"},className:"coupon-list-item-container gray "+(copied?"copied":"")},_react2["default"].createElement("h4",{className:"code midnight bold"},copied?_react2["default"].createElement("span",{className:"copied-text"},"COPIED"):wc.code,_react2["default"].createElement("span",{className:"hidden"},wc.code)))})):null,rewardFound?_react2["default"].createElement("div",{className:"center-content"},_react2["default"].createElement("div",{className:"activation-amount"},_react2["default"].createElement("h3",{className:"silver"},_react2["default"].createElement("span",{className:"palmetto bold"},"percentage"===reward.type?"+"+reward.amount/100+"%":"$"+reward.amount/100)," ",_react2["default"].createElement("span",{className:"antialiased"},"Wikibuy Credit")))):_react2["default"].createElement("div",{className:"center-content"},_react2["default"].createElement("h6",{className:"bold"},couponCount," ",1===couponCount?" code ":" best codes "," tested in ",runTimeSeconds," sec.")),_react2["default"].createElement("div",{className:"dismiss-notif"},_react2["default"].createElement("h4",{className:"primary-link bold",onClick:this.props.onClosePopup.bind(this)},"Continue to Checkout")))}},{key:"onClickCopy",value:function(coupon){var _this3=this;(0,_copyToClip2["default"])(coupon),this.setState({copied:coupon},function(){_this3.timeoutId=setTimeout(function(){_this3.setState({copied:!1})},1e3)}),(0,_sendMetric2["default"])("trackClick","copyCouponCode","code",{domain:location.hostname.replace(/^www\./,""),pagePath:location.pathname})}}]),NoSavingsAvailable}(_react.Component);exports["default"]=NoSavingsAvailable},797:function(module,exports){"use strict";function copyToClip(str){return document.oncopy=function(event){event.clipboardData.setData("text/plain",str),event.preventDefault(),document.oncopy=null},document.execCommand("copy",!1,null),!0}Object.defineProperty(exports,"__esModule",{value:!0}),exports["default"]=copyToClip},798:196,799:function(module,exports,__webpack_require__){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{"default":obj}}Object.defineProperty(exports,"__esModule",{value:!0});var _getPrototypeOf=__webpack_require__(91),_getPrototypeOf2=_interopRequireDefault(_getPrototypeOf),_classCallCheck2=__webpack_require__(95),_classCallCheck3=_interopRequireDefault(_classCallCheck2),_createClass2=__webpack_require__(96),_createClass3=_interopRequireDefault(_createClass2),_possibleConstructorReturn2=__webpack_require__(99),_possibleConstructorReturn3=_interopRequireDefault(_possibleConstructorReturn2),_inherits2=__webpack_require__(101),_inherits3=_interopRequireDefault(_inherits2),_react=__webpack_require__(85),_react2=_interopRequireDefault(_react),_hasFeature=__webpack_require__(374),_hasFeature2=_interopRequireDefault(_hasFeature),_lodash=__webpack_require__(143),_lodash2=_interopRequireDefault(_lodash),_sendMetric=__webpack_require__(134),_sendMetric2=_interopRequireDefault(_sendMetric),_Star=__webpack_require__(800),_Star2=_interopRequireDefault(_Star),ReviewWikibuy=function(_Component){function ReviewWikibuy(){var _ref;(0,_classCallCheck3["default"])(this,ReviewWikibuy);for(var _len=arguments.length,args=Array(_len),_key=0;_key<_len;_key++)args[_key]=arguments[_key];var _this=(0,_possibleConstructorReturn3["default"])(this,(_ref=ReviewWikibuy.__proto__||(0,_getPrototypeOf2["default"])(ReviewWikibuy)).call.apply(_ref,[this].concat(args)));return _this.state={deduction:5},_this}return(0,_inherits3["default"])(ReviewWikibuy,_Component),(0,_createClass3["default"])(ReviewWikibuy,[{key:"componentDidMount",value:function(){(0,_sendMetric2["default"])("track","reviewWikibuyVisible",{})}},{key:"render",value:function(){var _this2=this;return this.state.confirmation?_react2["default"].createElement("span",null):_react2["default"].createElement("div",{className:"review-wrapper"},_react2["default"].createElement("h4",{className:"bold charcoal",style:{textAlign:"center",marginBottom:15}},"How would you rate Wikibuy?"),_react2["default"].createElement("div",{className:"review-wikibuy"},_lodash2["default"].map(new Array(5),function(it,i){return _react2["default"].createElement(_Star2["default"],{onClick:_this2.starWikibuy.bind(_this2,i),rating:i,key:i,type:_this2.state.deduction<=i?"fill":"empty"})})))}},{key:"starWikibuy",value:function(deduction){this.setState({deduction:deduction}),this.rateWikibuy("star",deduction)}},{key:"checkStars",value:function(label){var deduction=this.state.deduction;0===deduction?this.rateWikibuy(label,deduction):this.rateWikibuy(label,deduction)}},{key:"rateWikibuy",value:function(label,deduction){var savings=this.props.savings;(0,_sendMetric2["default"])("trackClick","rateWikibuy",label,{domain:location.hostname.replace(/^www\./,""),pagePath:location.pathname,savings:savings,rating:5-deduction}),0===deduction&&((0,_hasFeature2["default"])("rw_control")?window.open("https://chrome.google.com/webstore/detail/wikibuy/nenlahapcbofgnanklpelkaejcehkggg/reviews?hl=en-US","_blank"):(0,_hasFeature2["default"])("rw_reviewopedia")?window.open("http://www.reviewopedia.com/wikibuy-reviews#addreview","_blank"):(0,_hasFeature2["default"])("rw_trust_pilot")?window.open("https://www.trustpilot.com/review/wikibuy.com","_blank"):window.open("https://chrome.google.com/webstore/detail/wikibuy/nenlahapcbofgnanklpelkaejcehkggg/reviews?hl=en-US","_blank")),this.props.onClosePopup("rate wikibuy")}}]),ReviewWikibuy}(_react.Component);exports["default"]=ReviewWikibuy},800:function(module,exports,__webpack_require__){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{"default":obj}}Object.defineProperty(exports,"__esModule",{value:!0});var _getPrototypeOf=__webpack_require__(91),_getPrototypeOf2=_interopRequireDefault(_getPrototypeOf),_classCallCheck2=__webpack_require__(95),_classCallCheck3=_interopRequireDefault(_classCallCheck2),_createClass2=__webpack_require__(96),_createClass3=_interopRequireDefault(_createClass2),_possibleConstructorReturn2=__webpack_require__(99),_possibleConstructorReturn3=_interopRequireDefault(_possibleConstructorReturn2),_inherits2=__webpack_require__(101),_inherits3=_interopRequireDefault(_inherits2),_react=__webpack_require__(85),_react2=_interopRequireDefault(_react),Star=function(_React$Component){function Star(){return(0,_classCallCheck3["default"])(this,Star),(0,_possibleConstructorReturn3["default"])(this,(Star.__proto__||(0,_getPrototypeOf2["default"])(Star)).apply(this,arguments))}return(0,_inherits3["default"])(Star,_React$Component),(0,_createClass3["default"])(Star,[{key:"render",value:function(){return"half"===this.props.type?this.half():this.full(this.props.type)}},{key:"half",value:function(){return _react2["default"].createElement("svg",{className:"nc-icon glyph star",x:"0px",y:"0px",width:"48px",height:"48px",viewBox:"-281 373 48 48"},_react2["default"].createElement("g",null,_react2["default"].createElement("path",{fill:"#E8E8E8",stroke:"#acaaaa",d:"M-256.1,376l6.5,13.2l14.6,2.1c0.8,0.1,1.1,1.1,0.6,1.7l-10.5,10.3l2.5,14.5c0.1,0.8-0.7,1.4-1.5,1.1l-13-6.9 l-13,6.9c-0.7,0.4-1.6-0.2-1.5-1.1l2.5-14.5l-10.5-10.3c-0.6-0.6-0.3-1.6,0.6-1.7l14.6-2.1l6.5-13.2 C-257.5,375.2-256.5,375.2-256.1,376z"})),_react2["default"].createElement("g",null,_react2["default"].createElement("path",{fill:"#F9C319",d:"M-257,412l-13,6.9c-0.7,0.4-1.6-0.2-1.5-1.1l2.5-14.5l-10.5-10.3c-0.6-0.6-0.3-1.6,0.6-1.7l14.6-2.1l6.5-13.2 c0.2-0.4,0.5-0.6,0.9-0.6L-257,412z"})))}},{key:"full",value:function(type){var empty="empty"===this.props.type;return _react2["default"].createElement("svg",{onClick:this.props.onClick?this.props.onClick.bind(this,this.props.rating):null,className:"nc-icon glyph star",x:"0px",y:"0px",width:"48px",height:"48px",viewBox:"0 0 48 48"},_react2["default"].createElement("g",null,_react2["default"].createElement("path",{fill:empty?"#E8E8E8":"#f9c319",stroke:empty?"#acaaaa":"#f9c319",d:"M24.897,2.99l6.521,13.211l14.577,2.119c0.82,0.119,1.148,1.127,0.554,1.706L36,30.307l2.49,14.52 c0.14,0.817-0.717,1.44-1.451,1.054l-13.038-6.854l-13.04,6.856C10.227,46.27,9.37,45.647,9.51,44.83L12,30.307L1.451,20.026 c-0.594-0.578-0.266-1.587,0.554-1.706l14.577-2.119L23.103,2.99C23.47,2.247,24.53,2.247,24.897,2.99z"})))}}]),Star}(_react2["default"].Component);exports["default"]=Star},801:function(module,exports,__webpack_require__){"use strict";function _interopRequireWildcard(obj){if(obj&&obj.__esModule)return obj;var newObj={};if(null!=obj)for(var key in obj)Object.prototype.hasOwnProperty.call(obj,key)&&(newObj[key]=obj[key]);return newObj["default"]=obj,newObj}function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{"default":obj}}Object.defineProperty(exports,"__esModule",{value:!0});var _regenerator=__webpack_require__(57),_regenerator2=_interopRequireDefault(_regenerator),_asyncToGenerator2=__webpack_require__(84),_asyncToGenerator3=_interopRequireDefault(_asyncToGenerator2),_getPrototypeOf=__webpack_require__(91),_getPrototypeOf2=_interopRequireDefault(_getPrototypeOf),_classCallCheck2=__webpack_require__(95),_classCallCheck3=_interopRequireDefault(_classCallCheck2),_createClass2=__webpack_require__(96),_createClass3=_interopRequireDefault(_createClass2),_possibleConstructorReturn2=__webpack_require__(99),_possibleConstructorReturn3=_interopRequireDefault(_possibleConstructorReturn2),_inherits2=__webpack_require__(101),_inherits3=_interopRequireDefault(_inherits2),_react=__webpack_require__(85),_react2=_interopRequireDefault(_react),_reactDom=__webpack_require__(376),_copyToClip=__webpack_require__(797),_copyToClip2=_interopRequireDefault(_copyToClip),_hasFeature=__webpack_require__(374),_hasFeature2=_interopRequireDefault(_hasFeature),_lodash=__webpack_require__(143),_lodash2=_interopRequireDefault(_lodash),_sendMetric=__webpack_require__(134),_sendMetric2=_interopRequireDefault(_sendMetric),_Loader=__webpack_require__(802),_Loader2=_interopRequireDefault(_Loader),_inviteFriendsActions=__webpack_require__(805),actions=_interopRequireWildcard(_inviteFriendsActions),_OptionSelectInput=__webpack_require__(807),_OptionSelectInput2=_interopRequireDefault(_OptionSelectInput),_constants=__webpack_require__(193),_InviteTest=(__webpack_require__(812),
__webpack_require__(814)),_emailValidation=(_interopRequireDefault(_InviteTest),/^(([^<>()\[\]\\.,;:\s@"]+(\.[^<>()\[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/),InviteFriends=function(_Component){function InviteFriends(){var _ref;(0,_classCallCheck3["default"])(this,InviteFriends);for(var _len=arguments.length,args=Array(_len),_key=0;_key<_len;_key++)args[_key]=arguments[_key];var _this=(0,_possibleConstructorReturn3["default"])(this,(_ref=InviteFriends.__proto__||(0,_getPrototypeOf2["default"])(InviteFriends)).call.apply(_ref,[this].concat(args)));return _this.state={success:!1,referral_emails:[],firstname:null,lastname:null},_this}return(0,_inherits3["default"])(InviteFriends,_Component),(0,_createClass3["default"])(InviteFriends,[{key:"componentDidMount",value:function(){(0,_sendMetric2["default"])("track","referWikibuyVisible",{})}},{key:"render",value:function(){var _this2=this;return this.state.success||this.state.addName?this.state.addName?_react2["default"].createElement("div",{className:"invite-wrapper add-name"},_react2["default"].createElement("div",{className:"designed-form"},_react2["default"].createElement("h2",null,"Tell your friends who invited them to Wikibuy."),_react2["default"].createElement("input",{placeholder:"your name",ref:function(r){return _this2.nameInput=(0,_reactDom.findDOMNode)(r)},type:"input",value:this.state.firstname||"",onChange:this.onChangeName.bind(this),autoFocus:!0}),_react2["default"].createElement("button",{onClick:this.inviteFriends.bind(this),className:"primary-btn-large",disabled:!this.state.firstname||this.state.sendingInvites},this.state.sendingInvites?_react2["default"].createElement(_Loader2["default"],{color:"#ccc",size:20,direction:"left"},"Sending"):"Invite"))):this.state.success?_react2["default"].createElement("div",{className:"invite-wrapper success"}):null:_react2["default"].createElement("div",{className:"invite-wrapper"},_react2["default"].createElement("h2",null,"invite friends to save"),_react2["default"].createElement("div",{className:"invite-friends"},_react2["default"].createElement(_OptionSelectInput2["default"],{valid:this.state.valid,onValidEdit:this.onValidEdit.bind(this),placeholder:"enter recipient email addresses",inputItems:this.state.referral_emails,validation:this.emailValidation.bind(this),onAddEmail:this.addEmails.bind(this),page:"inviteFriendsPage",autoCompleteData:[],autoCompleteFilter:function(){}}),_react2["default"].createElement("div",{onClick:this.importGoogle.bind(this),className:"import-google-contacts"},_react2["default"].createElement("span",{className:"gmail-logo"}),_react2["default"].createElement("h4",{className:"bold"},"import Google contacts")),_react2["default"].createElement("button",{onClick:this.props.firstname||this.state.firstname?this.inviteFriends.bind(this):this.addName.bind(this),className:"primary-btn-large",disabled:!this.state.valid||this.state.sendingInvites},this.state.sendingInvites?_react2["default"].createElement(_Loader2["default"],{color:"#ccc",size:20,direction:"left"},"sending"):"invite"),(0,_hasFeature2["default"])("notif_invite_friends")?_react2["default"].createElement("h4",{onClick:this.copyReferral.bind(this,"text"),className:"copy-referral-link tertiary-link"},this.state.copied?"copied":"copy invite link"):_react2["default"].createElement("button",{onClick:this.copyReferral.bind(this,"button"),className:"primary-btn-large green-outline-button"},this.state.copied?"copied":"copy invite link"),this.state.error===!1?_react2["default"].createElement("h4",{className:"bold note error"},"there was an error sending invites"):null))}},{key:"importGoogle",value:function(){function importGoogle(){return _ref2.apply(this,arguments)}var _ref2=(0,_asyncToGenerator3["default"])(_regenerator2["default"].mark(function _callee(){return _regenerator2["default"].wrap(function(_context){for(;;)switch(_context.prev=_context.next){case 0:(0,_sendMetric2["default"])("trackClick","importGoogleContactsLink","import Gmail contacts"),window.open(_constants.WIKIBUY_URL+"/account-settings/invite-friends","_blank");case 2:case"end":return _context.stop()}},_callee,this)}));return importGoogle}()},{key:"onChangeName",value:function(e){var value=this.nameInput.value;this.setState({firstname:value})}},{key:"copyReferral",value:function(type){var _this3=this;(0,_sendMetric2["default"])("trackClick","copyReferralLink",type);var link=_constants.WIKIBUY_URL+"/referral-code/"+this.props.shortCode;this.setState({copied:(0,_copyToClip2["default"])(link)},function(){_this3.timeoutId=setTimeout(function(){_this3.setState({copied:!1})},1e3)})}},{key:"addName",value:function(){(0,_sendMetric2["default"])("trackClick","addNameToInvite","invite"),this.setState({addName:!0})}},{key:"inviteFriends",value:function(){function inviteFriends(){return _ref3.apply(this,arguments)}var _ref3=(0,_asyncToGenerator3["default"])(_regenerator2["default"].mark(function _callee2(){var emails,success;return _regenerator2["default"].wrap(function(_context2){for(;;)switch(_context2.prev=_context2.next){case 0:return emails=_lodash2["default"].map(this.state.referral_emails,function(email){return email.value}),this.state.validEdit&&emails.push(this.state.validEdit),this.setState({sendingInvites:!0}),(0,_sendMetric2["default"])("trackClick","submitInvite","invite",{numberOfInvites:_lodash2["default"].get(emails,"length")}),_context2.next=6,actions.sendInvites({referral_emails:emails,first_name:this.props.firstname||this.state.firstname,last_name:this.props.lastname||this.state.lastname});case 6:if(success=_context2.sent,!success){_context2.next=10;break}return this.props.onClosePopup(),_context2.abrupt("return");case 10:this.setState({sendingInvites:!1,success:success,addName:!1});case 11:case"end":return _context2.stop()}},_callee2,this)}));return inviteFriends}()},{key:"addEmails",value:function(emails){var _this4=this;emails&&emails.length?this.setState({referral_emails:emails,validEdit:!1},function(){_this4.validateEmails()}):this.setState({referral_emails:[],valid:!1})}},{key:"onValidEdit",value:function(email){var invalid=_lodash2["default"].filter(this.state.referral_emails,function(email){return!email.valid});this.setState({valid:!invalid.length&&email,validEdit:email})}},{key:"emailValidation",value:function(value){return _emailValidation.test(value)}},{key:"validateEmails",value:function(){var emails=this.state.referral_emails,invalid=_lodash2["default"].filter(emails,function(email){return!email.valid});this.setState({valid:!invalid.length&&emails.length})}}]),InviteFriends}(_react.Component);exports["default"]=InviteFriends},802:function(module,exports,__webpack_require__){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{"default":obj}}Object.defineProperty(exports,"__esModule",{value:!0});var _getPrototypeOf=__webpack_require__(91),_getPrototypeOf2=_interopRequireDefault(_getPrototypeOf),_classCallCheck2=__webpack_require__(95),_classCallCheck3=_interopRequireDefault(_classCallCheck2),_createClass2=__webpack_require__(96),_createClass3=_interopRequireDefault(_createClass2),_possibleConstructorReturn2=__webpack_require__(99),_possibleConstructorReturn3=_interopRequireDefault(_possibleConstructorReturn2),_inherits2=__webpack_require__(101),_inherits3=_interopRequireDefault(_inherits2),_react=__webpack_require__(85),_react2=_interopRequireDefault(_react),_reactDom=__webpack_require__(376),_classnames=__webpack_require__(803),_classnames2=_interopRequireDefault(_classnames);__webpack_require__(804);var Loader=function(_React$Component){function Loader(){var _ref;(0,_classCallCheck3["default"])(this,Loader);for(var _len=arguments.length,args=Array(_len),_key=0;_key<_len;_key++)args[_key]=arguments[_key];var _this=(0,_possibleConstructorReturn3["default"])(this,(_ref=Loader.__proto__||(0,_getPrototypeOf2["default"])(Loader)).call.apply(_ref,[this].concat(args)));return _this.state={},_this}return(0,_inherits3["default"])(Loader,_React$Component),(0,_createClass3["default"])(Loader,[{key:"componentDidMount",value:function(){if(!this.props.loaded){var width=(0,_reactDom.findDOMNode)(this.refs.spinner).clientWidth||this.props.size,height=(0,_reactDom.findDOMNode)(this.refs.spinner).clientHeight||this.props.size;this.setState({width:width,height:height})}}},{key:"render",value:function(){if(this.props.loaded)return!1;var styles={fontSize:this.props.size,width:this.props.size,height:this.props.size,color:this.props.color},margins={marginLeft:this.props.disableAutoMargins?0:-this.state.width/2,marginTop:this.props.disableAutoMargins?0:-this.state.height/2,width:this.state.width},classes=(0,_classnames2["default"])(this.props.classNames,this.props.direction,"loader");return _react2["default"].createElement("div",{ref:"spinner",style:this.state.width?margins:null,className:classes},_react2["default"].createElement("div",{className:"spin icon-refresh",style:styles}),this.props.children)}}]),Loader}(_react2["default"].Component);Loader.defaultProps={size:29},exports["default"]=Loader},803:function(module,exports,__webpack_require__){var __WEBPACK_AMD_DEFINE_ARRAY__,__WEBPACK_AMD_DEFINE_RESULT__;/*!
	  Copyright (c) 2016 Jed Watson.
	  Licensed under the MIT License (MIT), see
	  http://jedwatson.github.io/classnames
	*/
!function(){"use strict";function classNames(){for(var classes=[],i=0;i<arguments.length;i++){var arg=arguments[i];if(arg){var argType=typeof arg;if("string"===argType||"number"===argType)classes.push(arg);else if(Array.isArray(arg))classes.push(classNames.apply(null,arg));else if("object"===argType)for(var key in arg)hasOwn.call(arg,key)&&arg[key]&&classes.push(key)}}return classes.join(" ")}var hasOwn={}.hasOwnProperty;"undefined"!=typeof module&&module.exports?module.exports=classNames:(__WEBPACK_AMD_DEFINE_ARRAY__=[],__WEBPACK_AMD_DEFINE_RESULT__=function(){return classNames}.apply(exports,__WEBPACK_AMD_DEFINE_ARRAY__),!(void 0!==__WEBPACK_AMD_DEFINE_RESULT__&&(module.exports=__WEBPACK_AMD_DEFINE_RESULT__)))}()},804:196,805:function(module,exports,__webpack_require__){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{"default":obj}}Object.defineProperty(exports,"__esModule",{value:!0}),exports.sendInvites=void 0;var _regenerator=__webpack_require__(57),_regenerator2=_interopRequireDefault(_regenerator),_asyncToGenerator2=__webpack_require__(84),_asyncToGenerator3=_interopRequireDefault(_asyncToGenerator2),_lodash=(exports.sendInvites=function(){var _ref=(0,_asyncToGenerator3["default"])(_regenerator2["default"].mark(function _callee(data){var success;return _regenerator2["default"].wrap(function(_context){for(;;)switch(_context.prev=_context.next){case 0:return success=void 0,data.referral_emails=_lodash2["default"].uniq(data.referral_emails),data.feature=(0,_hasFeature2["default"])("referral_inc_control")?"referral_inc_control":(0,_hasFeature2["default"])("referral_inc_gg5")?"referral_inc_gg5":(0,_hasFeature2["default"])("referral_inc_g5")?"referral_inc_g5":"",_context.prev=3,_context.next=6,(0,_inviteFriends2["default"])(data);case 6:success=!0,_context.next=12;break;case 9:_context.prev=9,_context.t0=_context["catch"](3),success=!1;case 12:return _context.abrupt("return",success);case 13:case"end":return _context.stop()}},_callee,this,[[3,9]])}));return function(_x){return _ref.apply(this,arguments)}}(),__webpack_require__(143)),_lodash2=_interopRequireDefault(_lodash),_hasFeature=__webpack_require__(374),_hasFeature2=_interopRequireDefault(_hasFeature),_inviteFriends=__webpack_require__(806),_inviteFriends2=_interopRequireDefault(_inviteFriends)},806:function(module,exports,__webpack_require__){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{"default":obj}}Object.defineProperty(exports,"__esModule",{value:!0});var _messenger=__webpack_require__(135),_messenger2=_interopRequireDefault(_messenger);exports["default"]=function(data){return(0,_messenger2["default"])("inviteFriends",data)}},807:function(module,exports,__webpack_require__){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{"default":obj}}var _from=__webpack_require__(646),_from2=_interopRequireDefault(_from),_getPrototypeOf=__webpack_require__(91),_getPrototypeOf2=_interopRequireDefault(_getPrototypeOf),_classCallCheck2=__webpack_require__(95),_classCallCheck3=_interopRequireDefault(_classCallCheck2),_createClass2=__webpack_require__(96),_createClass3=_interopRequireDefault(_createClass2),_possibleConstructorReturn2=__webpack_require__(99),_possibleConstructorReturn3=_interopRequireDefault(_possibleConstructorReturn2),_inherits2=__webpack_require__(101),_inherits3=_interopRequireDefault(_inherits2),_react=__webpack_require__(85),_react2=_interopRequireDefault(_react),_hasFeature=__webpack_require__(374),_hasFeature2=_interopRequireDefault(_hasFeature),_lodash=__webpack_require__(143),_lodash2=_interopRequireDefault(_lodash),_reactInputAutosize=__webpack_require__(808),_reactInputAutosize2=_interopRequireDefault(_reactInputAutosize),_Autocomplete=__webpack_require__(809),_Autocomplete2=_interopRequireDefault(_Autocomplete),_reactDom=__webpack_require__(376),_propTypes=__webpack_require__(111),_propTypes2=_interopRequireDefault(_propTypes);__webpack_require__(811);var OptionSelectInput=function(_React$Component){function OptionSelectInput(){var _ref;(0,_classCallCheck3["default"])(this,OptionSelectInput);for(var _len=arguments.length,args=Array(_len),_key=0;_key<_len;_key++)args[_key]=arguments[_key];var _this=(0,_possibleConstructorReturn3["default"])(this,(_ref=OptionSelectInput.__proto__||(0,_getPrototypeOf2["default"])(OptionSelectInput)).call.apply(_ref,[this].concat(args)));return _this.state={field:null},_this}return(0,_inherits3["default"])(OptionSelectInput,_React$Component),(0,_createClass3["default"])(OptionSelectInput,[{key:"render",value:function(){var autoCompleteData=this.props.autoCompleteData||[],selectItems=this.renderSelectItems(),inputEl=this.renderInput(),styles={width:this.props.width,minHeight:this.props.height};return _react2["default"].createElement("div",{className:"option-select-wrapper"},_react2["default"].createElement("div",{className:this.state.focus?"focus option-select-input":"option-select-input",onClick:this.focusFieldInput.bind(this),style:styles},_react2["default"].createElement("div",{className:"select-control"},selectItems,this.state.editable?null:inputEl)),autoCompleteData.length&&this.state.inputValue?_react2["default"].createElement(_Autocomplete2["default"],{onAutoCompleteAction:this.onAutoCompleteAction.bind(this),onClickAutoCompleteItem:this.onClickAutoCompleteItem.bind(this),onClearAutoCompleteAction:this.onClearAutoCompleteAction.bind(this),data:this.props.autoCompleteData}):null)}},{key:"renderInput",value:function(focus){var _this2=this,hiddenInputStyle=((0,_hasFeature2["default"])("referral_get5")||(0,_hasFeature2["default"])("referral_get5_go")||(0,_hasFeature2["default"])("referral_get5_links"),{minWidth:10,width:"100%"}),items=_lodash2["default"].get(this.props,"inputItems.length")?"items":"";return _react2["default"].createElement("div",{key:"render-input",className:"select-input "+(items?"":"placeholder")},_react2["default"].createElement(_reactInputAutosize2["default"],{placeholder:items?"":this.props.placeholder||"Enter recipient email addresses",onChange:this.inputUpdate.bind(this),onBlur:this.blurField.bind(this),onFocus:this.focusFieldInput.bind(this),value:this.state.inputValue,ref:function(r){return _this2.focusField=(0,_reactDom.findDOMNode)(r)},style:hiddenInputStyle}))}},{key:"renderSelectItems",value:function(){var _this3=this,editableIndex=_lodash2["default"].get(this.state,"editable.index");return _lodash2["default"].map(this.props.inputItems,function(item,i){var value=item.value.replace(/ /g,"_"),valid=item.valid?"valid":"invalid";return editableIndex===i?_this3.renderInput(!0):_react2["default"].createElement("div",{key:i+"-"+value,className:"select-item "+valid,onDoubleClick:_this3.editValue.bind(_this3,item),onClick:_this3.stopProp.bind(_this3)},_react2["default"].createElement("div",{className:"flex-wrapper"},_react2["default"].createElement("span",{className:"value"},item.value),_react2["default"].createElement("span",{onClick:_this3.removeValue.bind(_this3,item),className:"close"},_react2["default"].createElement("span",{className:"icon-x"}))))})}},{key:"onAutoCompleteAction",value:function(){this.setState({autoCompleteAction:!0})}},{key:"onClearAutoCompleteAction",value:function(){this.setState({autoCompleteAction:!1})}},{key:"focusFieldInput",value:function(){this.setState({focus:!0});var focusedEl=this.focusField;focusedEl&&focusedEl.childNodes&&(0,_from2["default"])(focusedEl.childNodes).forEach(function(s){s.focus&&s.focus()})}},{key:"blurField",value:function(e){if(!this.state.autoCompleteAction){this.onKeyDown(e,!0),this.setState({focus:!1});var focusedEl=this.focusField;focusedEl&&focusedEl.childNodes&&(0,_from2["default"])(focusedEl.childNodes).forEach(function(s){s.blur&&s.blur()})}}},{key:"stopProp",value:function(e){e.stopPropagation()}},{key:"removeValue",value:function(value){var items=_lodash2["default"].clone(this.props.inputItems),index=_lodash2["default"].findIndex(items,{value:value.value});items.splice(index,1),this.props.onAddEmail(items)}},{key:"editValue",value:function(value){var _this4=this,items=_lodash2["default"].clone(this.props.inputItems),index=_lodash2["default"].findIndex(items,{value:value.value});this.setState({editable:{value:value.value,index:index}},function(){_this4.inputUpdate(null,value.value),_this4.focusFieldInput()})}},{key:"componentDidMount",value:function(){this.bindedKeyDown=this.onKeyDown.bind(this),this.bindedKeyUp=this.onKeyUp.bind(this),document.addEventListener("keydown",this.bindedKeyDown),document.addEventListener("keyup",this.bindedKeyUp)}},{key:"componentWillUnmount",value:function(){document.removeEventListener("keydown",this.bindedKeyDown),document.removeEventListener("keyup",this.bindedKeyUp)}},{key:"onClickAutoCompleteItem",value:function(item,e){var _this5=this;this.setState({inputValue:item,autoCompleteAction:!1},function(){_this5.onKeyDown(e,!0)})}},{key:"inputUpdate",value:function(e,valueOverride){var value=e?this.focusField.querySelector("input").value.replace(",",""):valueOverride;this.props.autoCompleteFilter&&this.state.inputValue&&this.props.autoCompleteFilter(value),this.setState({inputValue:value})}},{key:"newInputField",value:function(){var _this6=this,value=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";this.setState({inputValue:value,editable:null},function(){_this6.focusFieldInput()})}},{key:"onKeyUp",value:function(){var focusedEl=this.focusField,value="";focusedEl&&focusedEl.childNodes&&((0,_from2["default"])(focusedEl.childNodes).forEach(function(s){s.value&&!value&&(value=s.value)}),value=value.trim()),this.state.focus&&value&&(!this.props.validation(value)&&this.props.valid?this.props.onValidEdit(!1):this.props.validation(value)&&this.props.onValidEdit(value))}},{key:"onKeyDown",value:function(e,blur){var _this7=this;if(!this.state.autoCompleteAction){var editable=_lodash2["default"].get(this.state,"editable"),focusedEl=this.focusField,value="";focusedEl&&focusedEl.childNodes&&((0,_from2["default"])(focusedEl.childNodes).forEach(function(s){s.value&&!value&&(value=s.value)}),value=value.trim());var options=_lodash2["default"].clone(this.props.inputItems),actionKey=13===e.which||188===e.which||9===e.which||32===e.which;if(13!==e.which||this.state.inputValue||e.preventDefault(),!this.state.focus||8!==e.which||value&&1!==value.length||!options||!options.length){if(this.state.focus&&(actionKey||blur)&&value){e.preventDefault();var inputObj=_lodash2["default"].map(value.split(" "),function(value){return{value:value,valid:_this7.props.validation(value)}});editable?_lodash2["default"].forEach(inputObj,function(value,i){options[editable.index+i]=value}):options=options.concat(inputObj),this.props.onAddEmail(_lodash2["default"].uniq(options)),this.newInputField()}}else if(editable&&1===options.length)e.preventDefault(),this.removeValue(options[options.length-1]),setTimeout(function(){_this7.newInputField()});else if(editable&&options.length>1){e.preventDefault();var next=options[options.length-2];next&&(this.removeValue(options[options.length-1]),setTimeout(function(){_this7.editValue(next)}))}else editable||(e.preventDefault(),this.editValue(options[options.length-1]))}}}]),OptionSelectInput}(_react2["default"].Component);OptionSelectInput.defaultProps={inputItems:[],width:"100%",height:"70px"},OptionSelectInput.propTypes={width:_propTypes2["default"].string,height:_propTypes2["default"].string,inputItems:_propTypes2["default"].array.isRequired,autoCompleteFilter:_propTypes2["default"].func,autoCompleteData:_propTypes2["default"].array,page:_propTypes2["default"].string},module.exports=OptionSelectInput},808:function(module,exports,__webpack_require__){"use strict";var _extends=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source)Object.prototype.hasOwnProperty.call(source,key)&&(target[key]=source[key])}return target},React=__webpack_require__(85),PropTypes=__webpack_require__(111),createClass=__webpack_require__(323),sizerStyle={position:"absolute",top:0,left:0,visibility:"hidden",height:0,overflow:"scroll",whiteSpace:"pre"},AutosizeInput=createClass({propTypes:{className:PropTypes.string,defaultValue:PropTypes.any,inputClassName:PropTypes.string,inputRef:PropTypes.func,inputStyle:PropTypes.object,minWidth:PropTypes.oneOfType([PropTypes.number,PropTypes.string]),onAutosize:PropTypes.func,onChange:PropTypes.func,placeholder:PropTypes.string,placeholderIsMinWidth:PropTypes.bool,style:PropTypes.object,value:PropTypes.any},getDefaultProps:function(){return{minWidth:1}},getInitialState:function(){return{inputWidth:this.props.minWidth,inputId:"_"+Math.random().toString(36).substr(2,12)}},componentDidMount:function(){this.mounted=!0,this.copyInputStyles(),this.updateInputWidth()},componentDidUpdate:function(prevProps,prevState){prevState.inputWidth!==this.state.inputWidth&&"function"==typeof this.props.onAutosize&&this.props.onAutosize(this.state.inputWidth),this.updateInputWidth()},componentWillUnmount:function(){this.mounted=!1},inputRef:function(el){this.input=el,"function"==typeof this.props.inputRef&&this.props.inputRef(el)},placeHolderSizerRef:function(el){this.placeHolderSizer=el},sizerRef:function(el){this.sizer=el},copyInputStyles:function(){if(this.mounted&&window.getComputedStyle){var inputStyle=this.input&&window.getComputedStyle(this.input);if(inputStyle){var widthNode=this.sizer;if(widthNode.style.fontSize=inputStyle.fontSize,widthNode.style.fontFamily=inputStyle.fontFamily,widthNode.style.fontWeight=inputStyle.fontWeight,widthNode.style.fontStyle=inputStyle.fontStyle,widthNode.style.letterSpacing=inputStyle.letterSpacing,widthNode.style.textTransform=inputStyle.textTransform,this.props.placeholder){var placeholderNode=this.placeHolderSizer;placeholderNode.style.fontSize=inputStyle.fontSize,placeholderNode.style.fontFamily=inputStyle.fontFamily,placeholderNode.style.fontWeight=inputStyle.fontWeight,placeholderNode.style.fontStyle=inputStyle.fontStyle,placeholderNode.style.letterSpacing=inputStyle.letterSpacing,placeholderNode.style.textTransform=inputStyle.textTransform}}}},updateInputWidth:function(){if(this.mounted&&this.sizer&&"undefined"!=typeof this.sizer.scrollWidth){var newInputWidth=void 0;newInputWidth=this.props.placeholder&&(!this.props.value||this.props.value&&this.props.placeholderIsMinWidth)?Math.max(this.sizer.scrollWidth,this.placeHolderSizer.scrollWidth)+2:this.sizer.scrollWidth+2,newInputWidth<this.props.minWidth&&(newInputWidth=this.props.minWidth),newInputWidth!==this.state.inputWidth&&this.setState({inputWidth:newInputWidth})}},getInput:function(){return this.input},focus:function(){this.input.focus()},blur:function(){this.input.blur()},select:function(){this.input.select()},render:function(){var sizerValue=[this.props.defaultValue,this.props.value,""].reduce(function(previousValue,currentValue){return null!==previousValue&&void 0!==previousValue?previousValue:currentValue}),wrapperStyle=this.props.style||{};wrapperStyle.display||(wrapperStyle.display="inline-block");var inputStyle=_extends({},this.props.inputStyle);inputStyle.width=this.state.inputWidth+"px",inputStyle.boxSizing="content-box";var inputProps=_extends({},this.props);return inputProps.className=this.props.inputClassName,inputProps.style=inputStyle,delete inputProps.inputClassName,delete inputProps.inputStyle,delete inputProps.minWidth,delete inputProps.onAutosize,delete inputProps.placeholderIsMinWidth,delete inputProps.inputRef,React.createElement("div",{className:this.props.className,style:wrapperStyle},React.createElement("style",{dangerouslySetInnerHTML:{__html:["input#"+this.state.id+"::-ms-clear {display: none;}"].join("\n")}}),React.createElement("input",_extends({id:this.state.id},inputProps,{ref:this.inputRef})),React.createElement("div",{ref:this.sizerRef,style:sizerStyle},sizerValue),this.props.placeholder?React.createElement("div",{ref:this.placeHolderSizerRef,style:sizerStyle},this.props.placeholder):null)}});module.exports=AutosizeInput},809:function(module,exports,__webpack_require__){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{"default":obj}}Object.defineProperty(exports,"__esModule",{value:!0});var _getPrototypeOf=__webpack_require__(91),_getPrototypeOf2=_interopRequireDefault(_getPrototypeOf),_classCallCheck2=__webpack_require__(95),_classCallCheck3=_interopRequireDefault(_classCallCheck2),_createClass2=__webpack_require__(96),_createClass3=_interopRequireDefault(_createClass2),_possibleConstructorReturn2=__webpack_require__(99),_possibleConstructorReturn3=_interopRequireDefault(_possibleConstructorReturn2),_inherits2=__webpack_require__(101),_inherits3=_interopRequireDefault(_inherits2),_react=__webpack_require__(85),_react2=_interopRequireDefault(_react),_lodash=__webpack_require__(143),_lodash2=_interopRequireDefault(_lodash);__webpack_require__(810);var Autocomplete=function(_Component){function Autocomplete(){var _ref;(0,_classCallCheck3["default"])(this,Autocomplete);for(var _len=arguments.length,args=Array(_len),_key=0;_key<_len;_key++)args[_key]=arguments[_key];var _this=(0,_possibleConstructorReturn3["default"])(this,(_ref=Autocomplete.__proto__||(0,_getPrototypeOf2["default"])(Autocomplete)).call.apply(_ref,[this].concat(args)));return _this.state={active:-1},_this}return(0,_inherits3["default"])(Autocomplete,_Component),(0,_createClass3["default"])(Autocomplete,[{key:"componentDidMount",value:function(){this.bindedKeyDown=this.onKeyDown.bind(this),document.addEventListener("keydown",this.bindedKeyDown)}},{key:"componentWillUnmount",value:function(){this.props.onClearAutoCompleteAction(),document.removeEventListener("keydown",this.bindedKeyDown)}},{key:"componentWillReceiveProps",value:function(nextProps){nextProps.data!==this.props.data&&(this.setState({active:-1}),this.props.onClearAutoCompleteAction())}},{key:"onKeyDown",value:function(e){if(38===e.which&&this.state.active>0)e.preventDefault(),this.props.onAutoCompleteAction(),this.setState({active:this.state.active-1}),this.scrollToActive(-1);else if(40===e.which&&this.state.active<this.props.data.length-1)e.preventDefault(),this.props.onAutoCompleteAction(),this.setState({active:this.state.active+1}),this.scrollToActive(1);else if(13===e.which&&this.state.active>-1){e.stopPropagation(),e.preventDefault();var data=this.props.data[this.state.active];this.props.onClickAutoCompleteItem(data.email,e)}else 38!==e.which&&40!==e.which||e.preventDefault()}},{key:"scrollToActive",value:function(direction){var pos=this.activeItem.offsetTop;this.scrollList.scrollTop=pos}},{key:"render",value:function(){var _this2=this;return _react2["default"].createElement("div",{ref:function(r){return _this2.scrollList=r},className:"auto-complete-wrapper"},_react2["default"].createElement("ul",{className:"auto-complete"},_lodash2["default"].map(this.props.data,function(data,i){var active=_this2.state.active===i;return _react2["default"].createElement("li",{ref:function(r){return active?_this2.activeItem=r:null},className:active?"active":"",onMouseDown:_this2.props.onAutoCompleteAction.bind(_this2),onMouseOver:_this2.setActive.bind(_this2,i),onClick:_this2.props.onClickAutoCompleteItem.bind(_this2,data.email),key:"auto-complete-item-"+i},_react2["default"].createElement("h3",{className:"bold"},data.name),_react2["default"].createElement("h3",null,data.email))})))}},{key:"setActive",value:function(index){this.setState({active:index})}}]),Autocomplete}(_react.Component);exports["default"]=Autocomplete},810:196,811:196,812:function(module,exports,__webpack_require__){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{"default":obj}}Object.defineProperty(exports,"__esModule",{value:!0}),exports.getContactsFromBg=void 0;var _regenerator=__webpack_require__(57),_regenerator2=_interopRequireDefault(_regenerator),_asyncToGenerator2=__webpack_require__(84),_asyncToGenerator3=_interopRequireDefault(_asyncToGenerator2),_state=(exports.getContactsFromBg=function(){var _ref=(0,_asyncToGenerator3["default"])(_regenerator2["default"].mark(function _callee(data){var contacts;return _regenerator2["default"].wrap(function(_context){for(;;)switch(_context.prev=_context.next){case 0:return _context.next=2,(0,_getGoogleContacts2["default"])(data);case 2:return contacts=_context.sent,_lodash2["default"].get(data,"contacts")||(0,_sendMetric2["default"])("track","importGoogleContactsSuccessful",{pageLocation:"extension"}),_state2["default"].set(["googleData"],contacts),_context.abrupt("return",contacts);case 6:case"end":return _context.stop()}},_callee,this)}));return function(_x){return _ref.apply(this,arguments)}}(),__webpack_require__(141)),_state2=_interopRequireDefault(_state),_sendMetric=__webpack_require__(134),_sendMetric2=_interopRequireDefault(_sendMetric),_lodash=__webpack_require__(143),_lodash2=_interopRequireDefault(_lodash),_getGoogleContacts=__webpack_require__(813),_getGoogleContacts2=_interopRequireDefault(_getGoogleContacts)},813:function(module,exports,__webpack_require__){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{"default":obj}}Object.defineProperty(exports,"__esModule",{value:!0});var _messenger=__webpack_require__(135),_messenger2=_interopRequireDefault(_messenger);exports["default"]=function(data){return(0,_messenger2["default"])("getGoogleContacts",data)}},814:function(module,exports,__webpack_require__){"use strict";function _interopRequireWildcard(obj){if(obj&&obj.__esModule)return obj;var newObj={};if(null!=obj)for(var key in obj)Object.prototype.hasOwnProperty.call(obj,key)&&(newObj[key]=obj[key]);return newObj["default"]=obj,newObj}function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{"default":obj}}Object.defineProperty(exports,"__esModule",{value:!0});var _regenerator=__webpack_require__(57),_regenerator2=_interopRequireDefault(_regenerator),_asyncToGenerator2=__webpack_require__(84),_asyncToGenerator3=_interopRequireDefault(_asyncToGenerator2),_getPrototypeOf=__webpack_require__(91),_getPrototypeOf2=_interopRequireDefault(_getPrototypeOf),_classCallCheck2=__webpack_require__(95),_classCallCheck3=_interopRequireDefault(_classCallCheck2),_createClass2=__webpack_require__(96),_createClass3=_interopRequireDefault(_createClass2),_possibleConstructorReturn2=__webpack_require__(99),_possibleConstructorReturn3=_interopRequireDefault(_possibleConstructorReturn2),_inherits2=__webpack_require__(101),_inherits3=_interopRequireDefault(_inherits2),_react=__webpack_require__(85),_react2=_interopRequireDefault(_react),_currency=__webpack_require__(815),_reactDom=(_interopRequireDefault(_currency),__webpack_require__(376)),_copyToClip=__webpack_require__(797),_copyToClip2=_interopRequireDefault(_copyToClip),_hasFeature=__webpack_require__(374),_lodash=(_interopRequireDefault(_hasFeature),__webpack_require__(143)),_lodash2=_interopRequireDefault(_lodash),_sendMetric=__webpack_require__(134),_sendMetric2=_interopRequireDefault(_sendMetric),_Loader=__webpack_require__(802),_Loader2=_interopRequireDefault(_Loader),_inviteFriendsActions=__webpack_require__(805),actions=_interopRequireWildcard(_inviteFriendsActions),_OptionSelectInput=__webpack_require__(807),_OptionSelectInput2=_interopRequireDefault(_OptionSelectInput),_ContactsList=__webpack_require__(816),_ContactsList2=_interopRequireDefault(_ContactsList),_constants=__webpack_require__(193),_oauthActions=__webpack_require__(812);__webpack_require__(819);var _emailValidation=/^(([^<>()\[\]\\.,;:\s@"]+(\.[^<>()\[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/,InviteFriends=function(_Component){function InviteFriends(){var _ref;(0,_classCallCheck3["default"])(this,InviteFriends);for(var _len=arguments.length,args=Array(_len),_key=0;_key<_len;_key++)args[_key]=arguments[_key];var _this=(0,_possibleConstructorReturn3["default"])(this,(_ref=InviteFriends.__proto__||(0,_getPrototypeOf2["default"])(InviteFriends)).call.apply(_ref,[this].concat(args)));return _this.winWidth=520,_this.winHeight=400,_this.state={success:!1,referral_emails:[],google_contacts_added:[],firstname:null,lastname:null},_this}return(0,_inherits3["default"])(InviteFriends,_Component),(0,_createClass3["default"])(InviteFriends,[{key:"componentWillMount",value:function(){(0,_oauthActions.getContactsFromBg)({contacts:!0})}},{key:"componentDidMount",value:function(){(0,_sendMetric2["default"])("track","referWikibuyVisible",{})}},{key:"toggleContact",value:function(contact){var contacts=_lodash2["default"].clone(this.state.google_contacts_added);_lodash2["default"].find(contacts,contact)?contacts=_lodash2["default"].pull(contacts,contact):contacts.push(contact),this.setState({google_contacts_added:contacts})}},{key:"addAllContacts",value:function(contacts){this.setState({google_contacts_added:contacts})}},{key:"render",value:function(){var _this2=this,referralEmails=_lodash2["default"].filter(this.state.referral_emails,{valid:!0}),added=[].concat(this.state.google_contacts_added).concat(referralEmails);added=_lodash2["default"].uniqBy(added,function(c){var v=c.email||c.value||c.name;return v}),added=added.length;var url=this.props.shortCode?_constants.WIKIBUY_URL+"/referral-code/"+this.props.shortCode:"https://wikibuy.com/instant",campaign="facebook_referral",googleContactsLoaded=_lodash2["default"].get(this.props.googleContacts,"contacts.length")&&this.state.inviteByGoogle;return this.state.success||this.state.addName?this.state.addName?_react2["default"].createElement("div",{className:"invite-wrapper add-name"},_react2["default"].createElement("div",{className:"designed-form"},_react2["default"].createElement("h3",{className:"bold charcoal"},"Tell your friends who invited them to Wikibuy."),_react2["default"].createElement("input",{placeholder:"Your name",ref:function(r){return _this2.nameInput=(0,_reactDom.findDOMNode)(r)},type:"input",value:this.state.firstname||"",onChange:this.onChangeName.bind(this),autoFocus:!0}),_react2["default"].createElement("button",{onClick:this.inviteFriends.bind(this),className:"primary-btn-large name-submit",disabled:!this.state.firstname||this.state.sendingInvites},this.state.sendingInvites?_react2["default"].createElement(_Loader2["default"],{color:"#ccc",size:20}):"Share"))):this.state.success?_react2["default"].createElement("div",{className:"invite-wrapper success"},_react2["default"].createElement("h3",{style:{textAlign:"center"},className:"bold palmetto"},"Your invites have been sent!")):null:_react2["default"].createElement("div",{className:"invite-wrapper "+(googleContactsLoaded?"google-contacts-loaded":"")},googleContactsLoaded?null:_react2["default"].createElement("span",null,_react2["default"].createElement("h4",{className:"bold charcoal"},"Your friends can save too."),_react2["default"].createElement("h5",{className:"silver"},"Enter an email address to share with friends.")),googleContactsLoaded?_react2["default"].createElement("div",{className:"contact-list-wrapper"},_react2["default"].createElement(_ContactsList2["default"],{inviteFriendsView:{},hideFooter:!0,googleContacts:this.props.googleContacts,onAddContact:function(contact){return _this2.toggleContact(contact)},onAddAllContacts:function(contacts){return _this2.addAllContacts(contacts)},addedToInvite:this.state.google_contacts_added,sendingInvite:!1,allContactsInvited:!1,query:null}),_react2["default"].createElement("button",{onClick:this.props.firstname||this.state.firstname?this.inviteFriends.bind(this):this.addName.bind(this),className:"primary-btn-large google-contacts-submit",disabled:!this.state.valid&&!this.state.google_contacts_added.length||this.state.sendingInvites},this.state.sendingInvites?_react2["default"].createElement(_Loader2["default"],{color:"#ccc",size:20}):"Share")):null,googleContactsLoaded?null:_react2["default"].createElement("div",{className:"invite-flex-wrapper"},_react2["default"].createElement("div",{className:"invite-friends"},_react2["default"].createElement(_OptionSelectInput2["default"],{valid:this.state.valid,onValidEdit:this.onValidEdit.bind(this),placeholder:"Friend's email",inputItems:this.state.referral_emails,validation:this.emailValidation.bind(this),onAddEmail:this.addEmails.bind(this),page:"inviteFriendsPage",autoCompleteData:[],autoCompleteFilter:function(){}}),_react2["default"].createElement("h3",{className:"silver or"},"OR"),_react2["default"].createElement("div",{className:"share-flex"},_react2["default"].createElement("div",{onClick:this.fbShare.bind(this,url+"/?utm_campaign="+campaign+"&utm_source=facebook.com"),className:"share-facebook r-button"}),_react2["default"].createElement("div",{onClick:this.importGoogle.bind(this),className:"import-google-contacts"},_react2["default"].createElement("span",{className:"gmail-logo"})),_react2["default"].createElement("div",{onClick:this.copyReferral.bind(this,"text"),className:"share-link r-button"},this.state.copied?_react2["default"].createElement("h5",{className:"copy a"},"copied!"):null)),_react2["default"].createElement("button",{onClick:this.props.firstname||this.state.firstname?this.inviteFriends.bind(this):this.addName.bind(this),className:"primary-btn-large",disabled:!this.state.valid&&!this.state.google_contacts_added.length||this.state.sendingInvites},this.state.sendingInvites?_react2["default"].createElement(_Loader2["default"],{color:"#fff",size:20}):"Share"),this.state.error===!1?_react2["default"].createElement("h4",{className:"bold note error"},"there was an error sending invites"):null)))}},{key:"importGoogle",value:function(){function importGoogle(){return _ref2.apply(this,arguments)}var _ref2=(0,_asyncToGenerator3["default"])(_regenerator2["default"].mark(function _callee(){return _regenerator2["default"].wrap(function(_context){for(;;)switch(_context.prev=_context.next){case 0:(0,_sendMetric2["default"])("trackClick","importGoogleContacts","import Gmail contacts",{pageLocation:"extension"}),(0,_oauthActions.getContactsFromBg)(),this.setState({inviteByGoogle:!0});case 3:case"end":return _context.stop()}},_callee,this)}));return importGoogle}()},{key:"onChangeName",value:function(e){var value=this.nameInput.value;this.setState({firstname:value})}},{key:"copyReferral",value:function(type){var _this3=this;(0,_sendMetric2["default"])("trackClick","copyReferralLink",type,{pageLocation:"extension"});var link=_constants.WIKIBUY_URL+"/referral-code/"+this.props.shortCode;this.setState({copied:(0,_copyToClip2["default"])(link)},function(){_this3.timeoutId=setTimeout(function(){_this3.setState({copied:!1})},1e3)})}},{key:"addName",value:function(){(0,_sendMetric2["default"])("trackClick","addNameToInvite","invite",{pageLocation:"extension"}),this.setState({addName:!0})}},{key:"inviteFriends",value:function(){function inviteFriends(){return _ref3.apply(this,arguments)}var _ref3=(0,_asyncToGenerator3["default"])(_regenerator2["default"].mark(function _callee2(){var referalls,emails,success,_this4=this;return _regenerator2["default"].wrap(function(_context2){for(;;)switch(_context2.prev=_context2.next){case 0:return referalls=[].concat(this.state.referral_emails).concat(this.state.google_contacts_added),emails=_lodash2["default"].map(referalls,function(email){return email.value||email.email}),this.state.validEdit&&emails.push(this.state.validEdit),(0,_sendMetric2["default"])("trackClick","submitInvite","invite",{numberOfInvites:_lodash2["default"].get(emails,"length"),pageLocation:"extension"}),this.setState({sendingInvites:!0}),_context2.next=7,actions.sendInvites({referral_emails:emails,first_name:this.props.firstname||this.state.firstname,last_name:this.props.lastname||this.state.lastname});case 7:success=_context2.sent,success&&(this.addEmails([]),this.timeout=setTimeout(function(){_this4.setState({success:null,google_contacts_added:[]})},3e3)),this.setState({sendingInvites:!1,success:success,addName:!1,inviteByGoogle:!1});case 10:case"end":return _context2.stop();
}},_callee2,this)}));return inviteFriends}()},{key:"addEmails",value:function(emails){var _this5=this;emails&&emails.length?this.setState({referral_emails:emails,validEdit:!1},function(){_this5.validateEmails()}):this.setState({referral_emails:[],valid:!1})}},{key:"onValidEdit",value:function(email){var invalid=_lodash2["default"].filter(this.state.referral_emails,function(email){return!email.valid});this.setState({valid:!invalid.length&&email,validEdit:email})}},{key:"emailValidation",value:function(value){return _emailValidation.test(value)}},{key:"validateEmails",value:function(){var emails=this.state.referral_emails,invalid=_lodash2["default"].filter(emails,function(email){return!email.valid});this.setState({valid:!invalid.length&&emails.length})}},{key:"componentWillUnmount",value:function(){clearTimeout(this.timeout)}},{key:"fbShare",value:function(url,e){e.stopPropagation(),(0,_sendMetric2["default"])("trackClick","shareFacebook","Share on facebook",{pageLocation:"extension"});var title="Wikibuy",image="https://wikibuy.com/assets/images/wikibuy_logo.png",message="Get $5 towards your first purchase on Wikibuy. Save time and money when you shop on Amazon.";this.createPopup("http://www.facebook.com/sharer.php?s=100&p[title]="+title+"&p[summary]="+message+"&p[url]="+url+"&p[images][0]="+image,"Share")}},{key:"createPopup",value:function(url,name){var winTop=screen.height/2-this.winWidth/2,winLeft=screen.width/2-this.winWidth/2;window.open(url,name,"top="+winTop+",left="+winLeft+",toolbar=0,status=0,width="+this.winWidth+",height="+this.winHeight)}},{key:"select",value:function(){(0,_sendMetric2["default"])("trackClick","selectReferralLink","invite friends",{pageLocation:"extension"}),this.refs.referralInput.select()}}]),InviteFriends}(_react.Component);exports["default"]=InviteFriends},816:function(module,exports,__webpack_require__){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{"default":obj}}function transformContacts(contacts,query){return f.set(contacts),query&&query.length<32?f.search(query):null}Object.defineProperty(exports,"__esModule",{value:!0});var _toConsumableArray2=__webpack_require__(645),_toConsumableArray3=_interopRequireDefault(_toConsumableArray2),_defineProperty2=__webpack_require__(453),_defineProperty3=_interopRequireDefault(_defineProperty2),_getPrototypeOf=__webpack_require__(91),_getPrototypeOf2=_interopRequireDefault(_getPrototypeOf),_classCallCheck2=__webpack_require__(95),_classCallCheck3=_interopRequireDefault(_classCallCheck2),_createClass2=__webpack_require__(96),_createClass3=_interopRequireDefault(_createClass2),_possibleConstructorReturn2=__webpack_require__(99),_possibleConstructorReturn3=_interopRequireDefault(_possibleConstructorReturn2),_inherits2=__webpack_require__(101),_inherits3=_interopRequireDefault(_inherits2),_react=__webpack_require__(85),_react2=_interopRequireDefault(_react),_lodash=__webpack_require__(143),_lodash2=_interopRequireDefault(_lodash),_sendMetric=__webpack_require__(134),_sendMetric2=_interopRequireDefault(_sendMetric),_inviteFriendsActions=__webpack_require__(805),_Loader=__webpack_require__(802),_Loader2=_interopRequireDefault(_Loader),_fuse=__webpack_require__(817),_fuse2=_interopRequireDefault(_fuse);__webpack_require__(818);var options={keys:["email","name"],threshold:.3},f=new _fuse2["default"]([],options),ContactsList=function(_React$Component){function ContactsList(){var _ref;(0,_classCallCheck3["default"])(this,ContactsList);for(var _len=arguments.length,args=Array(_len),_key=0;_key<_len;_key++)args[_key]=arguments[_key];var _this=(0,_possibleConstructorReturn3["default"])(this,(_ref=ContactsList.__proto__||(0,_getPrototypeOf2["default"])(ContactsList)).call.apply(_ref,[this].concat(args)));return _this.state={active:-1},_this}return(0,_inherits3["default"])(ContactsList,_React$Component),(0,_createClass3["default"])(ContactsList,[{key:"componentDidMount",value:function(){this.setContacts(this.props)}},{key:"componentWillReceiveProps",value:function(nextProps){_lodash2["default"].isEqual(_lodash2["default"].get(nextProps,"googleContacts.contact"),_lodash2["default"].get(this.props,"googleContacts.contact"))&&this.setContacts(nextProps)}},{key:"setContacts",value:function(props){var contacts=_lodash2["default"].get(props,"googleContacts.contacts",[]),frequentContacts=_lodash2["default"].get(props,"googleContacts.frequentContacts",[]);this.setState({contacts:[].concat(frequentContacts,contacts)})}},{key:"componentDidUpdate",value:function(prevProps,prevState){if(prevState.query!==this.state.query){var filteredContacts=transformContacts(this.state.contacts,this.state.query);this.setState({filteredContacts:filteredContacts}),this.selectAll.checked=!1}}},{key:"render",value:function(){var _this2=this,numberAdded=this.props.addedToInvite.length,inviteFriends=_lodash2["default"].get(this.props,"inviteFriendsView",{}),awaitingSave=inviteFriends.awaitingContactSave,error=inviteFriends.error,success=inviteFriends.success,contacts=this.state.filteredContacts||this.state.contacts;return _react2["default"].createElement("div",{className:"contact-list"},_react2["default"].createElement("div",{className:"search "+(this.props.hideFooter?"overlay":"")},_react2["default"].createElement("span",{className:"icon icon-search"}),_react2["default"].createElement("input",{className:"search-input",onChange:this.handleChangeSearch.bind(this),onBlur:this.blurField.bind(this),onFocus:this.focusField.bind(this),placeholder:"Search contacts",type:"text",ref:function(r){r&&(_this2.input=r)}}),this.props.hideFooter?_react2["default"].createElement("div",{className:"flex"},_react2["default"].createElement("input",{type:"checkbox",ref:function(r){r&&(_this2.selectAll=r)},className:"send-invite",id:"select-all",onChange:this.onClickSelectAll.bind(this)}),_react2["default"].createElement("label",{htmlFor:"select-all"},"Select All")):null),_react2["default"].createElement("ul",{onMouseLeave:this.setActive.bind(this,-1),ref:"contactScrollList",className:"contacts"},_lodash2["default"].map(contacts,function(contact,i){var active=_this2.state.active===i;return _react2["default"].createElement("li",(0,_defineProperty3["default"])({key:"contact-"+i,ref:active?"activeContactItem":null,onMouseOver:_this2.setActive.bind(_this2,i),className:active?"active":""},"key","contact-"+i),_react2["default"].createElement("div",{className:"flex space"},_react2["default"].createElement("input",{disabled:contact.invited,type:"checkbox",className:"send-invite",id:"send-invite-"+i,checked:_lodash2["default"].find(_this2.props.addedToInvite,{email:contact.email}),onChange:_this2.props.onAddContact.bind(_this2,contact)}),_react2["default"].createElement("label",{htmlFor:"send-invite-"+i},_react2["default"].createElement("div",{className:"flex space"},_react2["default"].createElement("h5",{className:"one"},contact.name||contact.email),contact&&contact.name?_react2["default"].createElement("h4",{className:"two"},contact.email):null))))})),this.props.hideFooter?null:_react2["default"].createElement("footer",{className:"flex space"},_react2["default"].createElement("div",{className:"flex"},_react2["default"].createElement("input",{type:"checkbox",className:"send-invite",id:"select-all",onChange:this.onClickSelectAll.bind(this)}),_react2["default"].createElement("label",{htmlFor:"select-all"},"Select All")),success?_react2["default"].createElement("button",{className:"primary-btn-large sent",disabled:!0},_react2["default"].createElement("span",{className:"icon-circle-check"}),"Sent"):awaitingSave?_react2["default"].createElement("button",{className:"primary-btn-large",disabled:!0},_react2["default"].createElement(_Loader2["default"],{light:!0,scale:.5},"Sending")):_react2["default"].createElement("button",{onClick:this.onClickInvites.bind(this),className:"primary-btn-large",disabled:0===numberAdded},"Send ",numberAdded>0?numberAdded:""," ",1===numberAdded?"invite":"Invites")),error?_react2["default"].createElement("h3",{className:"error"},"There was an error, please try again"):null)}},{key:"onClickSelectAll",value:function(e){if(this.selectAll.checked){var contacts=this.state.filteredContacts||this.state.contacts,uniq=_lodash2["default"].uniqBy([].concat((0,_toConsumableArray3["default"])(contacts),(0,_toConsumableArray3["default"])(this.props.addedToInvite)),"email");this.props.onAddAllContacts(uniq)}else this.props.onAddAllContacts([])}},{key:"blurField",value:function(){this.setState({inputFocus:!1,active:-1})}},{key:"focusField",value:function(){this.setState({inputFocus:!0})}},{key:"setActive",value:function(index){this.setState({active:index})}},{key:"onClickInvites",value:function(){(0,_inviteFriendsActions.sendContactsInvite)(_lodash2["default"].map(this.props.addedToInvite,function(contact){return contact.email})),(0,_sendMetric2["default"])("trackClick","submitInvite","import Gmail contacts",{numberOfInvites:_lodash2["default"].get(this.props.addedToInvite,"length")}),this.props.onAdded&&this.props.onAdded(_lodash2["default"].get(this.props.addedToInvite,"length"))}},{key:"handleChangeSearch",value:function(e){this.setActive(-1),this.setState({query:this.input.value})}}]),ContactsList}(_react2["default"].Component);exports["default"]=ContactsList},817:function(module,exports,__webpack_require__){/**
	 * @license
	 * Fuse - Lightweight fuzzy-search
	 *
	 * Copyright (c) 2012 Kirollos Risk <kirollos@gmail.com>.
	 * All Rights Reserved. Apache Software License 2.0
	 *
	 * Licensed under the Apache License, Version 2.0 (the "License");
	 * you may not use this file except in compliance with the License.
	 * You may obtain a copy of the License at
	 *
	 * http://www.apache.org/licenses/LICENSE-2.0
	 *
	 * Unless required by applicable law or agreed to in writing, software
	 * distributed under the License is distributed on an "AS IS" BASIS,
	 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
	 * See the License for the specific language governing permissions and
	 * limitations under the License.
	 */
!function(global){function Fuse(list,options){this.list=list,this.options=options=options||{};var i,len,key,keys;for(i=0,keys=["sort","shouldSort"],len=keys.length;i<len;i++)key=keys[i],this.options[key]=key in options?options[key]:Fuse.defaultOptions[key];for(i=0,keys=["searchFn","sortFn","keys","getFn","include"],len=keys.length;i<len;i++)key=keys[i],this.options[key]=options[key]||Fuse.defaultOptions[key]}var BitapSearcher=function(pattern,options){if(options=options||{},this.options=options,this.options.location=options.location||BitapSearcher.defaultOptions.location,this.options.distance="distance"in options?options.distance:BitapSearcher.defaultOptions.distance,this.options.threshold="threshold"in options?options.threshold:BitapSearcher.defaultOptions.threshold,this.options.maxPatternLength=options.maxPatternLength||BitapSearcher.defaultOptions.maxPatternLength,this.pattern=options.caseSensitive?pattern:pattern.toLowerCase(),this.patternLen=pattern.length,this.patternLen>this.options.maxPatternLength)throw new Error("Pattern length is too long");this.matchmask=1<<this.patternLen-1,this.patternAlphabet=this._calculatePatternAlphabet()};BitapSearcher.defaultOptions={location:0,distance:100,threshold:.6,maxPatternLength:32},BitapSearcher.prototype._calculatePatternAlphabet=function(){var mask={},i=0;for(i=0;i<this.patternLen;i++)mask[this.pattern.charAt(i)]=0;for(i=0;i<this.patternLen;i++)mask[this.pattern.charAt(i)]|=1<<this.pattern.length-i-1;return mask},BitapSearcher.prototype._bitapScore=function(errors,location){var accuracy=errors/this.patternLen,proximity=Math.abs(this.options.location-location);return this.options.distance?accuracy+proximity/this.options.distance:proximity?1:accuracy},BitapSearcher.prototype.search=function(text){if(text=this.options.caseSensitive?text:text.toLowerCase(),this.pattern===text)return{isMatch:!0,score:0};var i,j,binMin,binMid,start,finish,bitArr,lastBitArr,charMatch,textLen=text.length,LOCATION=this.options.location,THRESHOLD=this.options.threshold,bestLoc=text.indexOf(this.pattern,LOCATION),binMax=this.patternLen+textLen,score=1,locations=[];for(bestLoc!=-1&&(THRESHOLD=Math.min(this._bitapScore(0,bestLoc),THRESHOLD),bestLoc=text.lastIndexOf(this.pattern,LOCATION+this.patternLen),bestLoc!=-1&&(THRESHOLD=Math.min(this._bitapScore(0,bestLoc),THRESHOLD))),bestLoc=-1,i=0;i<this.patternLen;i++){for(binMin=0,binMid=binMax;binMin<binMid;)this._bitapScore(i,LOCATION+binMid)<=THRESHOLD?binMin=binMid:binMax=binMid,binMid=Math.floor((binMax-binMin)/2+binMin);for(binMax=binMid,start=Math.max(1,LOCATION-binMid+1),finish=Math.min(LOCATION+binMid,textLen)+this.patternLen,bitArr=Array(finish+2),bitArr[finish+1]=(1<<i)-1,j=finish;j>=start;j--)if(charMatch=this.patternAlphabet[text.charAt(j-1)],0===i?bitArr[j]=(bitArr[j+1]<<1|1)&charMatch:bitArr[j]=(bitArr[j+1]<<1|1)&charMatch|((lastBitArr[j+1]|lastBitArr[j])<<1|1)|lastBitArr[j+1],bitArr[j]&this.matchmask&&(score=this._bitapScore(i,j-1),score<=THRESHOLD)){if(THRESHOLD=score,bestLoc=j-1,locations.push(bestLoc),!(bestLoc>LOCATION))break;start=Math.max(1,2*LOCATION-bestLoc)}if(this._bitapScore(i+1,LOCATION)>THRESHOLD)break;lastBitArr=bitArr}return{isMatch:bestLoc>=0,score:score}};var deepValueHelper=function(obj,path,list){var firstSegment,remaining,dotIndex;if(path){dotIndex=path.indexOf("."),dotIndex!==-1?(firstSegment=path.slice(0,dotIndex),remaining=path.slice(dotIndex+1)):firstSegment=path;var value=obj[firstSegment];if(value)if(remaining||"string"!=typeof value&&"number"!=typeof value)if(Utils.isArray(value))for(var i=0,len=value.length;i<len;i++)deepValueHelper(value[i],remaining,list);else remaining&&deepValueHelper(value,remaining,list);else list.push(value)}else list.push(obj);return list},Utils={deepValue:function(obj,path){return deepValueHelper(obj,path,[])},isArray:function(obj){return"[object Array]"===Object.prototype.toString.call(obj)}};Fuse.defaultOptions={id:null,caseSensitive:!1,include:[],shouldSort:!0,searchFn:BitapSearcher,sortFn:function(a,b){return a.score-b.score},getFn:Utils.deepValue,keys:[]},Fuse.prototype.set=function(list){return this.list=list,list},Fuse.prototype.search=function(pattern){var j,item,bitapResult,existingResult,searcher=new this.options.searchFn(pattern,this.options),list=this.list,dataLen=list.length,options=this.options,searchKeys=this.options.keys,searchKeysLen=searchKeys.length,rawResults=[],resultMap={},results=[],analyzeText=function(text,entity,index){if(void 0!==text&&null!==text)if("string"==typeof text)bitapResult=searcher.search(text),bitapResult.isMatch&&(existingResult=resultMap[index],existingResult?existingResult.score=Math.min(existingResult.score,bitapResult.score):(resultMap[index]={item:entity,score:bitapResult.score},rawResults.push(resultMap[index])));else if(Utils.isArray(text))for(var i=0;i<text.length;i++)analyzeText(text[i],entity,index)};if("string"==typeof list[0])for(var i=0;i<dataLen;i++)analyzeText(list[i],i,i);else for(var i=0;i<dataLen;i++)for(item=list[i],j=0;j<searchKeysLen;j++)analyzeText(options.getFn(item,searchKeys[j]),item,i);options.shouldSort&&rawResults.sort(options.sortFn);for(var replaceValue=options.id?function(i){rawResults[i].item=options.getFn(rawResults[i].item,options.id)[0]}:function(){},getItem=function(i){var resultItem;if(options.include.length>0){resultItem={item:rawResults[i].item};for(var j=0;j<options.include.length;j++){var includeVal=options.include[j];resultItem[includeVal]=rawResults[i][includeVal]}}else resultItem=rawResults[i].item;return resultItem},i=0,len=rawResults.length;i<len;i++)replaceValue(i),results.push(getItem(i));return results},module.exports=Fuse}(this)},818:196,819:196,820:function(module,exports,__webpack_require__){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{"default":obj}}Object.defineProperty(exports,"__esModule",{value:!0});var _getPrototypeOf=__webpack_require__(91),_getPrototypeOf2=_interopRequireDefault(_getPrototypeOf),_classCallCheck2=__webpack_require__(95),_classCallCheck3=_interopRequireDefault(_classCallCheck2),_createClass2=__webpack_require__(96),_createClass3=_interopRequireDefault(_createClass2),_possibleConstructorReturn2=__webpack_require__(99),_possibleConstructorReturn3=_interopRequireDefault(_possibleConstructorReturn2),_inherits2=__webpack_require__(101),_inherits3=_interopRequireDefault(_inherits2),_react=__webpack_require__(85),_react2=_interopRequireDefault(_react),_lodash=__webpack_require__(143);_interopRequireDefault(_lodash);__webpack_require__(821);var _hasFeature=__webpack_require__(374),_hasFeature2=_interopRequireDefault(_hasFeature),_sendMetric=__webpack_require__(134),_currentDomain=(_interopRequireDefault(_sendMetric),__webpack_require__(429)),_isFullAccount=(_interopRequireDefault(_currentDomain),__webpack_require__(311)),_isFullAccount2=_interopRequireDefault(_isFullAccount),CallToAction=function(_Component){function CallToAction(){return(0,_classCallCheck3["default"])(this,CallToAction),(0,_possibleConstructorReturn3["default"])(this,(CallToAction.__proto__||(0,_getPrototypeOf2["default"])(CallToAction)).apply(this,arguments))}return(0,_inherits3["default"])(CallToAction,_Component),(0,_createClass3["default"])(CallToAction,[{key:"render",value:function(){var _props=this.props,running=_props.running,result=_props.result,couponCount=_props.couponCount,savings=(_props.pageReload,_props.savings),loading=(_props.renderPostResultCtaInUi,_props.loading),roo=_props.roo,showSubscribe=(0,_hasFeature2["default"])("coupon_email_subscription")&&(0,_isFullAccount2["default"])()&&!roo;return _react2["default"].createElement("div",{className:"button-wrapper coupons-cta "+(showSubscribe?"subscribe":"")},loading?_react2["default"].createElement("div",{className:"loader-container"},_react2["default"].createElement("span",null,_react2["default"].createElement("h3",null,"Loading..."))):running||result?savings?null:_react2["default"].createElement("button",{className:"tertiary-btn-large round icon-x icon",onClick:this.props.onClosePopup.bind(this,"close")}):_react2["default"].createElement("button",{className:"primary-btn-large",disabled:running,onClick:this.props.onTryCodes.bind(this,!1)},"try ",1===couponCount?"code":"codes"),running||!result||savings?null:this.props.renderViewCodes())}}]),CallToAction}(_react.Component);exports["default"]=CallToAction},821:196,822:function(module,exports,__webpack_require__){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{"default":obj}}Object.defineProperty(exports,"__esModule",{value:!0});var _getPrototypeOf=__webpack_require__(91),_getPrototypeOf2=_interopRequireDefault(_getPrototypeOf),_classCallCheck2=__webpack_require__(95),_classCallCheck3=_interopRequireDefault(_classCallCheck2),_createClass2=__webpack_require__(96),_createClass3=_interopRequireDefault(_createClass2),_possibleConstructorReturn2=__webpack_require__(99),_possibleConstructorReturn3=_interopRequireDefault(_possibleConstructorReturn2),_inherits2=__webpack_require__(101),_inherits3=_interopRequireDefault(_inherits2),_react=__webpack_require__(85),_react2=_interopRequireDefault(_react),_currency=__webpack_require__(815),_currency2=_interopRequireDefault(_currency),_copyToClip=__webpack_require__(797),_copyToClip2=_interopRequireDefault(_copyToClip),_sendMetric=__webpack_require__(134),_sendMetric2=_interopRequireDefault(_sendMetric),_hasFeature=__webpack_require__(374),_lodash=(_interopRequireDefault(_hasFeature),__webpack_require__(143)),_lodash2=_interopRequireDefault(_lodash);__webpack_require__(823);var SavingsAvailable=function(_Component){function SavingsAvailable(){var _ref;(0,_classCallCheck3["default"])(this,SavingsAvailable);for(var _len=arguments.length,args=Array(_len),_key=0;_key<_len;_key++)args[_key]=arguments[_key];var _this=(0,_possibleConstructorReturn3["default"])(this,(_ref=SavingsAvailable.__proto__||(0,_getPrototypeOf2["default"])(SavingsAvailable)).call.apply(_ref,[this].concat(args)));return _this.state={viewCodes:!1},_this}return(0,_inherits3["default"])(SavingsAvailable,_Component),(0,_createClass3["default"])(SavingsAvailable,[{key:"render",value:function(){var _this2=this,_props=this.props,runTimeSeconds=_props.runTimeSeconds,couponCount=_props.couponCount,savings=_props.savings,reward=_props.reward,originalTotal=_props.originalTotal,workingCoupons=_props.workingCoupons,hasReward=reward&&reward.amount,WikibuyTotal=void 0;originalTotal!==-1&&(WikibuyTotal=originalTotal-Number(savings.replace("$","").replace(".","")));var totals=originalTotal&&originalTotal!==-1&&WikibuyTotal;return _react2["default"].createElement("div",{className:"savings-wrapper"},_react2["default"].createElement("div",{className:"coupon-count "+(hasReward?"":"no-reward")},this.props.requiresInput?_react2["default"].createElement("h2",null,"Code Entered"):_react2["default"].createElement("h2",null,_react2["default"].createElement("span",null,"You saved ",_react2["default"].createElement("span",{className:"palmetto"},savings))),workingCoupons.length&&totals?_react2["default"].createElement("div",{className:"view-codes-link-wrapper"},_react2["default"].createElement("h6",{onClick:function(){return _this2.setState({viewCodes:!_this2.state.viewCodes})},className:"clickable bold"},this.state.viewCodes?_react2["default"].createElement("span",null,"hide codes"):_react2["default"].createElement("span",null,workingCoupons.length," ",1===workingCoupons.length?" code ":" codes "," worked"))):workingCoupons.length?_react2["default"].createElement("h6",{className:"bold center"},workingCoupons.length," ",1===workingCoupons.length?" code ":" codes "," worked in ",runTimeSeconds," sec."):_react2["default"].createElement("h6",{className:"bold center"},couponCount," ",1===couponCount?" code ":" best codes "," tested in ",runTimeSeconds," sec.")),this.state.viewCodes?_react2["default"].createElement("div",{className:"view-codes"},this.renderWorkingCodes(workingCoupons)):null,hasReward||totals||workingCoupons.length?_react2["default"].createElement("div",{className:"center-content"},totals?_react2["default"].createElement("div",{className:"savings-breakdown "+(hasReward?"reward":"")},_react2["default"].createElement("h3",{className:"antialiased"},_react2["default"].createElement("span",{className:"part"},"Without Wikibuy")," ",_react2["default"].createElement("span",{className:"part"},(0,_currency2["default"])(originalTotal))),_react2["default"].createElement("h3",null,_react2["default"].createElement("span",{className:"part bold"},"With Wikibuy")," ",_react2["default"].createElement("span",{className:"part bold palmetto"},(0,_currency2["default"])(WikibuyTotal)))):_react2["default"].createElement("div",{className:"flex-center savings-breakdown "+(hasReward?"reward":"")},_react2["default"].createElement("div",{className:"code-scroll-container"},this.renderWorkingCodes(workingCoupons))),hasReward?_react2["default"].createElement("div",{className:"activation-amount"},_react2["default"].createElement("h3",{className:"silver"},_react2["default"].createElement("span",{className:"palmetto bold"},"percentage"===reward.type?"+"+reward.amount/100+"%":"$"+reward.amount/100)," ",_react2["default"].createElement("span",{className:"antialiased"},"Wikibuy Credit"))):null):null,_react2["default"].createElement("div",{className:"dismiss-notif"},_react2["default"].createElement("h4",{className:"primary-link bold",onClick:this.props.onClosePopup.bind(this)},"Continue to Checkout")))}},{key:"renderWorkingCodes",value:function(workingCoupons){var _this3=this;return _lodash2["default"].map(workingCoupons,function(wc,i){var copied=_this3.state.copied===wc.code;return _react2["default"].createElement("div",{onClick:_this3.onClickCopy.bind(_this3,wc.code),key:i,style:{animationDelay:50*(i+1)+"ms"},className:"coupon-list-item-container "+(copied?"copied":"")},_react2["default"].createElement("h4",{className:"code midnight bold"},copied?_react2["default"].createElement("span",{className:"copied-text"},"COPIED"):wc.code,_react2["default"].createElement("span",{className:"hidden"},wc.code)))})}},{key:"onClickCopy",value:function(coupon){var _this4=this;(0,_copyToClip2["default"])(coupon),this.setState({copied:coupon},function(){_this4.timeoutId=setTimeout(function(){_this4.setState({copied:!1})},1e3)}),(0,_sendMetric2["default"])("trackClick","copyCouponCode","code",{domain:location.hostname.replace(/^www\./,""),pagePath:location.pathname})}}]),SavingsAvailable}(_react.Component);exports["default"]=SavingsAvailable},823:196,824:function(module,exports,__webpack_require__){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{"default":obj}}Object.defineProperty(exports,"__esModule",{value:!0});var _getPrototypeOf=__webpack_require__(91),_getPrototypeOf2=_interopRequireDefault(_getPrototypeOf),_classCallCheck2=__webpack_require__(95),_classCallCheck3=_interopRequireDefault(_classCallCheck2),_createClass2=__webpack_require__(96),_createClass3=_interopRequireDefault(_createClass2),_possibleConstructorReturn2=__webpack_require__(99),_possibleConstructorReturn3=_interopRequireDefault(_possibleConstructorReturn2),_inherits2=__webpack_require__(101),_inherits3=_interopRequireDefault(_inherits2),_react=__webpack_require__(85),_react2=_interopRequireDefault(_react),_lodash=__webpack_require__(143),_lodash2=_interopRequireDefault(_lodash),_reactCollapse=__webpack_require__(825),_copyToClip=(_interopRequireDefault(_reactCollapse),__webpack_require__(797)),_copyToClip2=_interopRequireDefault(_copyToClip),_sendMetric=__webpack_require__(134),_sendMetric2=_interopRequireDefault(_sendMetric);__webpack_require__(828);var CouponListItem=function(_Component){function CouponListItem(){var _ref;(0,_classCallCheck3["default"])(this,CouponListItem);for(var _len=arguments.length,args=Array(_len),_key=0;_key<_len;_key++)args[_key]=arguments[_key];var _this=(0,_possibleConstructorReturn3["default"])(this,(_ref=CouponListItem.__proto__||(0,_getPrototypeOf2["default"])(CouponListItem)).call.apply(_ref,[this].concat(args)));return _this.state={copied:!1},_this}return(0,_inherits3["default"])(CouponListItem,_Component),(0,_createClass3["default"])(CouponListItem,[{key:"render",value:function(){var coupon=this.props.coupon;return _react2["default"].createElement("div",{className:"coupon-item-wrapper "+(this.props.active?"active":"")+" "+(coupon.success?"success":"finished")+" "+(this.state.copied?"copied":"")},_react2["default"].createElement("div",{className:"coupon-list-item-container",onClick:this.onClickCopy.bind(this)},_react2["default"].createElement("div",{className:"details"},_react2["default"].createElement("h4",{className:"code midnight bold"},coupon.code))))}},{key:"onClickCopy",value:function(){var _this2=this;this.setState({copied:(0,_copyToClip2["default"])(this.props.coupon.code)},function(){_this2.timeoutId=setTimeout(function(){_this2.setState({copied:!1})},1e3)}),(0,_sendMetric2["default"])("trackClick","copyCouponCode","code",{domain:location.hostname.replace(/^www\./,""),pagePath:location.pathname})}},{key:"componentWillUnmount",value:function(){clearTimeout(this.timeoutId)}}]),CouponListItem}(_react.Component);CouponListItem.defaultProps={stagger:400};var CouponList=function(_Component2){function CouponList(){var _ref2;(0,_classCallCheck3["default"])(this,CouponList);for(var _len2=arguments.length,args=Array(_len2),_key2=0;_key2<_len2;_key2++)args[_key2]=arguments[_key2];var _this3=(0,_possibleConstructorReturn3["default"])(this,(_ref2=CouponList.__proto__||(0,_getPrototypeOf2["default"])(CouponList)).call.apply(_ref2,[this].concat(args)));return _this3.state={active:_this3.props.currentCodeIndex>-1?_this3.props.currentCodeIndex:0},_this3}return(0,_inherits3["default"])(CouponList,_Component2),(0,_createClass3["default"])(CouponList,[{key:"componentDidMount",value:function(){var _this4=this,interval=this.props.runTimePerCoupon||(this.props.estimatedRunTime+1e3)/this.props.coupons.length;this.interval=setInterval(function(){var na=_this4.state.active+1;_this4.setState({active:na}),na===_this4.props.coupons.length-1&&clearInterval(_this4.interval)},interval)}},{key:"componentWillUnmount",value:function(){clearInterval(this.interval)}},{key:"render",value:function(){var _this5=this,style={WebkitTransform:"translate3d(0px, -"+40*(this.state.active-4)+"px, 0px)",transform:"translate3d(0px, -"+40*(this.state.active-4)+"px, 0px)",msTransform:"translate3d(0px, -"+40*(this.state.active-4)+"px, 0px)",WebkitTransition:"-webkit-transform 0.3ms ease",transition:"transform 0.3s ease"};return _react2["default"].createElement("div",{className:"code-list-wrapper"},_react2["default"].createElement("div",{style:this.state.active>4?style:{},className:"code-list "+(this.props.className||"")},_lodash2["default"].map(this.props.coupons,function(coupon,i){return _react2["default"].createElement(CouponListItem,{last:i===_this5.props.coupons.length-1,animationStagger:(_this5.props.estimatedRunTime+800)/_this5.props.coupons.length,running:_this5.props.running,result:_this5.props.result,key:i,index:i,active:_this5.state.active===i,coupon:coupon,disableChecks:_this5.props.disableChecks})})))}}]),CouponList}(_react.Component);exports["default"]=CouponList},825:function(module,exports,__webpack_require__){"use strict";var _require=__webpack_require__(826),Collapse=_require.Collapse,_require2=__webpack_require__(827),UnmountClosed=_require2.UnmountClosed;UnmountClosed.Collapse=Collapse,UnmountClosed.UnmountClosed=UnmountClosed,module.exports=UnmountClosed},826:function(module,exports,__webpack_require__){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{"default":obj}}function _objectWithoutProperties(obj,keys){var target={};for(var i in obj)keys.indexOf(i)>=0||Object.prototype.hasOwnProperty.call(obj,i)&&(target[i]=obj[i]);return target}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(self,call){if(!self)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!call||"object"!=typeof call&&"function"!=typeof call?self:call}function _inherits(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function, not "+typeof superClass);subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:!1,writable:!0,configurable:!0}}),superClass&&(Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass)}Object.defineProperty(exports,"__esModule",{value:!0}),exports.Collapse=void 0;var _extends=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source)Object.prototype.hasOwnProperty.call(source,key)&&(target[key]=source[key])}return target},_createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){return protoProps&&defineProperties(Constructor.prototype,protoProps),staticProps&&defineProperties(Constructor,staticProps),Constructor}}(),_react=__webpack_require__(85),_react2=_interopRequireDefault(_react),_propTypes=__webpack_require__(111),_propTypes2=_interopRequireDefault(_propTypes),_reactMotion=__webpack_require__(102),SPRING_PRECISION=1,WAITING="WAITING",RESIZING="RESIZING",RESTING="RESTING",IDLING="IDLING",noop=function(){return null},css={collapse:"ReactCollapse--collapse",content:"ReactCollapse--content"},Collapse=exports.Collapse=function(_React$PureComponent){function Collapse(props){_classCallCheck(this,Collapse);var _this=_possibleConstructorReturn(this,(Collapse.__proto__||Object.getPrototypeOf(Collapse)).call(this,props));return _initialiseProps.call(_this),_this.state={currentState:IDLING,from:0,to:0},_this}return _inherits(Collapse,_React$PureComponent),_createClass(Collapse,[{key:"componentDidMount",value:function(){var _props=this.props,isOpened=_props.isOpened,forceInitialAnimation=_props.forceInitialAnimation,onRest=_props.onRest;if(isOpened){var to=this.getTo();if(forceInitialAnimation){var from=this.wrapper.clientHeight;this.setState({currentState:RESIZING,from:from,to:to})}else this.setState({currentState:IDLING,from:to,to:to})}onRest()}},{key:"componentWillReceiveProps",value:function(nextProps){nextProps.hasNestedCollapse?nextProps.isOpened!==this.props.isOpened&&this.setState({currentState:WAITING}):this.state.currentState===IDLING&&(nextProps.isOpened||this.props.isOpened)&&this.setState({currentState:WAITING})}},{key:"componentDidUpdate",value:function(_,prevState){var _props2=this.props,isOpened=_props2.isOpened,onRest=_props2.onRest,onMeasure=_props2.onMeasure;if(this.state.currentState===IDLING)return void onRest();prevState.to!==this.state.to&&onMeasure({height:this.state.to,width:this.content.clientWidth});var from=this.wrapper.clientHeight,to=isOpened?this.getTo():0;return from!==to?void this.setState({currentState:RESIZING,from:from,to:to}):void(this.state.currentState!==RESTING&&this.state.currentState!==WAITING||this.setState({currentState:IDLING,from:from,to:to}))}},{key:"componentWillUnmount",value:function(){cancelAnimationFrame(this.raf)}},{key:"render",value:function(){return _react2["default"].createElement(_reactMotion.Motion,_extends({},this.getMotionProps(),{onRest:this.onRest,children:this.renderContent}))}}]),Collapse}(_react2["default"].PureComponent);Collapse.propTypes={isOpened:_propTypes2["default"].bool.isRequired,springConfig:_propTypes2["default"].objectOf(_propTypes2["default"].number),forceInitialAnimation:_propTypes2["default"].bool,hasNestedCollapse:_propTypes2["default"].bool,fixedHeight:_propTypes2["default"].number,theme:_propTypes2["default"].objectOf(_propTypes2["default"].string),style:_propTypes2["default"].object,onRender:_propTypes2["default"].func,onRest:_propTypes2["default"].func,onMeasure:_propTypes2["default"].func,children:_propTypes2["default"].node.isRequired},Collapse.defaultProps={forceInitialAnimation:!1,hasNestedCollapse:!1,fixedHeight:-1,style:{},theme:css,onRender:noop,onRest:noop,onMeasure:noop};var _initialiseProps=function(){var _this2=this;this.onContentRef=function(content){_this2.content=content},this.onWrapperRef=function(wrapper){_this2.wrapper=wrapper},this.onRest=function(){_this2.raf=requestAnimationFrame(_this2.setResting)},this.setResting=function(){_this2.setState({currentState:RESTING})},this.getTo=function(){var fixedHeight=_this2.props.fixedHeight;return fixedHeight>-1?fixedHeight:_this2.content.clientHeight},this.getWrapperStyle=function(height){if(_this2.state.currentState===IDLING&&_this2.state.to){var fixedHeight=_this2.props.fixedHeight;return fixedHeight>-1?{overflow:"hidden",height:fixedHeight}:{height:"auto"}}return _this2.state.currentState!==WAITING||_this2.state.to?{overflow:"hidden",height:Math.max(0,height)}:{overflow:"hidden",height:0}},this.getMotionProps=function(){var springConfig=_this2.props.springConfig;return _this2.state.currentState===IDLING?{defaultStyle:{height:_this2.state.to},style:{height:_this2.state.to}}:{defaultStyle:{height:_this2.state.from},style:{height:(0,_reactMotion.spring)(_this2.state.to,_extends({precision:SPRING_PRECISION},springConfig))}}},this.renderContent=function(_ref){var height=_ref.height,_props3=_this2.props,theme=(_props3.isOpened,_props3.springConfig,_props3.forceInitialAnimation,_props3.hasNestedCollapse,_props3.fixedHeight,_props3.theme),style=_props3.style,onRender=_props3.onRender,children=(_props3.onRest,_props3.onMeasure,_props3.children),props=_objectWithoutProperties(_props3,["isOpened","springConfig","forceInitialAnimation","hasNestedCollapse","fixedHeight","theme","style","onRender","onRest","onMeasure","children"]),_state=_this2.state,from=_state.from,to=_state.to;return onRender({current:height,from:from,to:to}),_react2["default"].createElement("div",_extends({ref:_this2.onWrapperRef,className:theme.collapse,style:_extends({},_this2.getWrapperStyle(Math.max(0,height)),style)},props),_react2["default"].createElement("div",{ref:_this2.onContentRef,className:theme.content},children))}}},827:function(module,exports,__webpack_require__){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{"default":obj}}function _objectWithoutProperties(obj,keys){var target={};for(var i in obj)keys.indexOf(i)>=0||Object.prototype.hasOwnProperty.call(obj,i)&&(target[i]=obj[i]);return target}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(self,call){if(!self)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!call||"object"!=typeof call&&"function"!=typeof call?self:call}function _inherits(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function, not "+typeof superClass);subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:!1,writable:!0,configurable:!0}}),superClass&&(Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass)}Object.defineProperty(exports,"__esModule",{value:!0}),exports.UnmountClosed=void 0;var _extends=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source)Object.prototype.hasOwnProperty.call(source,key)&&(target[key]=source[key])}return target},_createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){return protoProps&&defineProperties(Constructor.prototype,protoProps),staticProps&&defineProperties(Constructor,staticProps),Constructor}}(),_react=__webpack_require__(85),_react2=_interopRequireDefault(_react),_propTypes=__webpack_require__(111),_propTypes2=_interopRequireDefault(_propTypes),_Collapse=__webpack_require__(826),UnmountClosed=exports.UnmountClosed=function(_React$PureComponent){function UnmountClosed(props){_classCallCheck(this,UnmountClosed);var _this=_possibleConstructorReturn(this,(UnmountClosed.__proto__||Object.getPrototypeOf(UnmountClosed)).call(this,props));return _this.componentWillReceiveProps=function(_ref){var isOpened=_ref.isOpened;!_this.props.isOpened&&isOpened&&_this.setState({forceInitialAnimation:!0,shouldUnmount:!1})},_this.onRest=function(){var _this$props=_this.props,isOpened=_this$props.isOpened,onRest=_this$props.onRest;isOpened||_this.setState({shouldUnmount:!0}),onRest&&onRest.apply(void 0,arguments)},_this.state={shouldUnmount:!_this.props.isOpened,forceInitialAnimation:!_this.props.isOpened},_this}return _inherits(UnmountClosed,_React$PureComponent),_createClass(UnmountClosed,[{key:"render",value:function(){var _props=this.props,isOpened=_props.isOpened,props=(_props.onRest,_objectWithoutProperties(_props,["isOpened","onRest"])),_state=this.state,forceInitialAnimation=_state.forceInitialAnimation,shouldUnmount=_state.shouldUnmount;return shouldUnmount?null:_react2["default"].createElement(_Collapse.Collapse,_extends({forceInitialAnimation:forceInitialAnimation,isOpened:isOpened,onRest:this.onRest},props))}}]),UnmountClosed}(_react2["default"].PureComponent);UnmountClosed.propTypes={isOpened:_propTypes2["default"].bool.isRequired,onRest:_propTypes2["default"].func}},828:196,831:function(module,exports,__webpack_require__){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{"default":obj}}Object.defineProperty(exports,"__esModule",{value:!0});var _getPrototypeOf=__webpack_require__(91),_getPrototypeOf2=_interopRequireDefault(_getPrototypeOf),_classCallCheck2=__webpack_require__(95),_classCallCheck3=_interopRequireDefault(_classCallCheck2),_createClass2=__webpack_require__(96),_createClass3=_interopRequireDefault(_createClass2),_possibleConstructorReturn2=__webpack_require__(99),_possibleConstructorReturn3=_interopRequireDefault(_possibleConstructorReturn2),_inherits2=__webpack_require__(101),_inherits3=_interopRequireDefault(_inherits2),_react=__webpack_require__(85),_react2=_interopRequireDefault(_react);__webpack_require__(832);var ProgressBar=function(_React$Component){function ProgressBar(){var _ref;(0,_classCallCheck3["default"])(this,ProgressBar);for(var _len=arguments.length,args=Array(_len),_key=0;_key<_len;_key++)args[_key]=arguments[_key];var _this=(0,_possibleConstructorReturn3["default"])(this,(_ref=ProgressBar.__proto__||(0,_getPrototypeOf2["default"])(ProgressBar)).call.apply(_ref,[this].concat(args)));return _this.state={progress:0,end:0},_this}return(0,_inherits3["default"])(ProgressBar,_React$Component),(0,_createClass3["default"])(ProgressBar,[{key:"componentWillMount",value:function(){this.setState({progress:Math.round(100*(this.props.currentCodeIndex===-1?0:this.props.currentCodeIndex/this.props.coupons.length))}),this.setState({end:Math.round((this.props.currentCodeIndex===-1?1:this.props.currentCodeIndex+1)/this.props.coupons.length*100)}),this.initInterval()}},{key:"componentWillUnmount",value:function(){clearInterval(this.intervalId)}},{key:"componentWillReceiveProps",value:function(nextProps){!this.props.complete&&nextProps&&nextProps.complete?(clearInterval(this.intervalId),this.setState({progress:100})):!this.props.complete&&nextProps&&nextProps.currentCodeIndex&&(clearInterval(this.intervalId),this.setState({
progress:Math.round(nextProps.currentCodeIndex/this.props.coupons.length*100)}),this.setState({end:Math.round((nextProps.currentCodeIndex+1)/this.props.coupons.length*100)}),this.initInterval())}},{key:"initInterval",value:function(){var _this2=this;this.intervalId=setInterval(function(){_this2.state.progress<_this2.state.end?_this2.setState({progress:_this2.state.progress+1}):clearInterval(_this2.intervalId)},Math.round(this.props.runTimePerCoupon*this.props.coupons.length/100))}},{key:"render",value:function(){return _react2["default"].createElement("div",{className:this.props.rounded?"rounded progress-bar":"progress-bar"},_react2["default"].createElement("div",{className:"progress",style:{width:this.state.progress+"%"}}))}}]),ProgressBar}(_react2["default"].Component);ProgressBar.defaultProps={estimatedDuration:3e3},exports["default"]=ProgressBar},832:196,833:function(module,exports,__webpack_require__){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{"default":obj}}Object.defineProperty(exports,"__esModule",{value:!0});var _getPrototypeOf=__webpack_require__(91),_getPrototypeOf2=_interopRequireDefault(_getPrototypeOf),_classCallCheck2=__webpack_require__(95),_classCallCheck3=_interopRequireDefault(_classCallCheck2),_createClass2=__webpack_require__(96),_createClass3=_interopRequireDefault(_createClass2),_possibleConstructorReturn2=__webpack_require__(99),_possibleConstructorReturn3=_interopRequireDefault(_possibleConstructorReturn2),_inherits2=__webpack_require__(101),_inherits3=_interopRequireDefault(_inherits2),_react=__webpack_require__(85),_react2=_interopRequireDefault(_react),_CouponList=__webpack_require__(834),_CouponList2=_interopRequireDefault(_CouponList),_nodeUuid=__webpack_require__(389),_nodeUuid2=_interopRequireDefault(_nodeUuid),_couponActions=__webpack_require__(649),_cashbackActions=__webpack_require__(452),_hasFeature=__webpack_require__(374),_hasFeature2=_interopRequireDefault(_hasFeature),_sendMetric=__webpack_require__(134),_sendMetric2=_interopRequireDefault(_sendMetric),_currentDomain=__webpack_require__(429),_currentDomain2=_interopRequireDefault(_currentDomain),NoScript=function(_Component){function NoScript(){var _ref,_temp,_this,_ret;(0,_classCallCheck3["default"])(this,NoScript);for(var _len=arguments.length,args=Array(_len),_key=0;_key<_len;_key++)args[_key]=arguments[_key];return _temp=_this=(0,_possibleConstructorReturn3["default"])(this,(_ref=NoScript.__proto__||(0,_getPrototypeOf2["default"])(NoScript)).call.apply(_ref,[this].concat(args))),_this.state={showCodes:!1},_ret=_temp,(0,_possibleConstructorReturn3["default"])(_this,_ret)}return(0,_inherits3["default"])(NoScript,_Component),(0,_createClass3["default"])(NoScript,[{key:"render",value:function(){var _props$view=this.props.view,coupons=_props$view.coupons,result=_props$view.result,couponCount=_props$view.couponCount,_props=this.props,reward=_props.reward,postCoupons=_props.postCoupons;return _react2["default"].createElement("div",null,_react2["default"].createElement("div",null,this.props.reward&&this.state.showCodes?_react2["default"].createElement("h2",null,"Activated ",_react2["default"].createElement("span",{className:"palmetto"},"percentage"===reward.type?reward.amount/100+"% back":"$"+reward.amount/100+" in credit")):_react2["default"].createElement("h2",null,_react2["default"].createElement("span",null,"Found ",couponCount," ",1===couponCount?"code":"codes"),reward&&reward.amount&&(!postCoupons||(0,_hasFeature2["default"])("cp_credits_with_coupon_saver")||(0,_hasFeature2["default"])("cp_credits_with_coupon_no_saver"))?_react2["default"].createElement("span",null," and ",_react2["default"].createElement("br",null),"get ",_react2["default"].createElement("span",{className:"palmetto"},"percentage"===reward.type?reward.amount/100+"% back":"$"+reward.amount/100+" in credit")):null),this.state.showCodes?_react2["default"].createElement("h4",{className:"bold"},"click code to copy to clipboard."):_react2["default"].createElement("h4",{className:"bold"},"click show ",1===couponCount?"code":"codes"," to save.")),this.state.showCodes?_react2["default"].createElement("div",{className:"run-codes"},_react2["default"].createElement(_CouponList2["default"],{show:!0,result:result,running:!1,coupons:coupons,stagger:0,collapsable:!0})):_react2["default"].createElement("button",{className:"primary-btn-large",style:{width:"100%",fontWeight:"bold",marginTop:"20px"},onClick:this.onShowCodes.bind(this)},"Show ",1===couponCount?"code":"codes"))}},{key:"onShowCodes",value:function(){var reward=this.props.reward,domain=(0,_currentDomain2["default"])();if((0,_sendMetric2["default"])("trackClick","showCodesButton","show codes",{domain:domain,pagePath:location.pathname}),this.props.reward)(0,_cashbackActions.activateThroughPinnedTab)(),(0,_sendMetric2["default"])("track","activateCashbackRedirect",{domain:domain,pagePath:location.pathname,rewardAmount:reward.amount,rewardDisplay:reward.type});else{var clickId=_nodeUuid2["default"].v4().replace(/-/,"");(0,_couponActions.dropCookie)(clickId),(0,_sendMetric2["default"])("track","showCodes",{domain:domain,clickId:clickId})}this.setState({showCodes:!0})}}]),NoScript}(_react.Component);exports["default"]=NoScript},834:function(module,exports,__webpack_require__){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{"default":obj}}function CouponList(props){return props.collapsable?_react2["default"].createElement(_reactCollapse2["default"],{isOpened:!!props.show,className:"collapse"},_react2["default"].createElement("div",{className:"code-list "+(props.className||"")},_lodash2["default"].map(props.coupons,function(coupon,i){return _react2["default"].createElement(CouponListItem,{running:props.running,result:props.result,key:i,index:i,coupon:coupon,stagger:props.stagger,disableChecks:props.disableChecks})}))):_react2["default"].createElement("div",{className:"code-list "+(props.className||"")},_lodash2["default"].map(props.coupons,function(coupon,i){return _react2["default"].createElement(CouponListItem,{running:props.running,result:props.result,key:i,index:i,coupon:coupon,stagger:props.stagger,disableChecks:props.disableChecks})}))}Object.defineProperty(exports,"__esModule",{value:!0});var _getPrototypeOf=__webpack_require__(91),_getPrototypeOf2=_interopRequireDefault(_getPrototypeOf),_classCallCheck2=__webpack_require__(95),_classCallCheck3=_interopRequireDefault(_classCallCheck2),_createClass2=__webpack_require__(96),_createClass3=_interopRequireDefault(_createClass2),_possibleConstructorReturn2=__webpack_require__(99),_possibleConstructorReturn3=_interopRequireDefault(_possibleConstructorReturn2),_inherits2=__webpack_require__(101),_inherits3=_interopRequireDefault(_inherits2);exports["default"]=CouponList;var _react=__webpack_require__(85),_react2=_interopRequireDefault(_react),_lodash=__webpack_require__(143),_lodash2=_interopRequireDefault(_lodash),_reactCollapse=__webpack_require__(825),_reactCollapse2=_interopRequireDefault(_reactCollapse),_copyToClip=__webpack_require__(797),_copyToClip2=_interopRequireDefault(_copyToClip),_sendMetric=__webpack_require__(134),_sendMetric2=_interopRequireDefault(_sendMetric),CouponListItem=function(_Component){function CouponListItem(){var _ref;(0,_classCallCheck3["default"])(this,CouponListItem);for(var _len=arguments.length,args=Array(_len),_key=0;_key<_len;_key++)args[_key]=arguments[_key];var _this=(0,_possibleConstructorReturn3["default"])(this,(_ref=CouponListItem.__proto__||(0,_getPrototypeOf2["default"])(CouponListItem)).call.apply(_ref,[this].concat(args)));return _this.state={copied:!1},_this}return(0,_inherits3["default"])(CouponListItem,_Component),(0,_createClass3["default"])(CouponListItem,[{key:"render",value:function(){var coupon=this.props.coupon,stagger=this.props.result&&!this.props.running;return _react2["default"].createElement("div",{className:this.state.copied?"copied":""},_react2["default"].createElement("div",{className:"coupon-list-item-container",onClick:this.onClickCopy.bind(this)},_react2["default"].createElement("div",{className:"details"},_react2["default"].createElement("h4",{className:"code midnight bold"},coupon.code)),_react2["default"].createElement("div",{className:"savings"},this.state.copied?_react2["default"].createElement("span",{className:"copied-text"},"Copied"):null,coupon.success&&!this.props.disableChecks?_react2["default"].createElement("svg",{viewBox:"0 0 150 150"},_react2["default"].createElement("path",{d:"M10,30 l30,50 l95,-70",fill:"none",strokeWidth:"15",style:{stroke:"#01c049",strokeDasharray:"180px, 180px",strokeDashoffset:"0px",animationDelay:stagger?"0ms":this.props.stagger*this.props.index+"ms"}})):null)))}},{key:"onClickCopy",value:function(){var _this2=this;this.setState({copied:(0,_copyToClip2["default"])(this.props.coupon.code)},function(){_this2.timeoutId=setTimeout(function(){_this2.setState({copied:!1})},1e3)}),(0,_sendMetric2["default"])("trackClick","copyCouponCode","code",{domain:location.hostname.replace(/^www\./,""),pagePath:location.pathname})}},{key:"componentWillUnmount",value:function(){clearTimeout(this.timeoutId)}}]),CouponListItem}(_react.Component);CouponListItem.defaultProps={stagger:400}},835:196,836:196,837:196,838:function(module,exports,__webpack_require__){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{"default":obj}}function waitForSelector(selectorFn,cb){var el=selectorFn();if(el)return cb(el);var exponentialBackoff=(0,_backoff.exponential)({randomisationFactor:0,initialDelay:50,maxDelay:1500});exponentialBackoff.backoff(),exponentialBackoff.on("ready",function(){var el=selectorFn();return el?void cb(el):void exponentialBackoff.backoff()})}function buttonsLoaded(){try{var selector=document.querySelector("#honeyContainer").shadowRoot.querySelector("#honey").querySelectorAll("button");return selector.length&&selector}catch(e){return!1}}function ebatesLoaded(){try{return document.querySelector(".ebates-notification")}catch(e){return!1}}function popupLoaded(){return document.querySelector("#honeyContainer")}function addTryCouponsEvtListener(){waitForSelector(buttonsLoaded,function(buttons){var hButton=_lodash2["default"].last(buttons),tryCouponsButtonFound=hasTryCouponsButton(buttons);hButton&&hButton.addEventListener("click",function(){(0,_sendMetric2["default"])("track","honeyFindSavings",{domain:getDomain(),pagePath:location.pathname,url:location.href}),tryCouponsButtonFound&&(0,_sendMetric2["default"])("track","honeyTryCoupons",{domain:getDomain(),pagePath:location.pathname,url:location.href}),(0,_honeyStateCache2["default"])({action:"initSavingsCheck"}),checkUntilTimeout(savingsLoaded,4e4,500,handleHoneySavings)})})}function delay(interval){return new _bluebird2["default"](function(res){setTimeout(res,interval)})}function handleHoneySavings(data){if(data){var savings=data.savings,originalPrice=data.originalPrice;(0,_honeyStateCache2["default"])({action:"endSavingsCheck"}),(0,_sendMetric2["default"])("track","honeySavingsFound",{originalPrice:originalPrice,savings:savings,domain:getDomain(),pagePath:location.pathname,url:location.href}),_state2["default"].set(["warnAboutStandDown"],!0)}}function getDomain(){if(currentDomain)return currentDomain;var domain=location.hostname.replace(/^www\./,"");return domain=(0,_shopify2["default"])(domain)||domain}function hasTryCouponsButton(buttons){return _lodash2["default"].find(buttons,function(button){return/coupon(?:s)?|code(?:s)?/i.test(button.innerHTML)})||_lodash2["default"].find(document.querySelector("#honeyContainer").shadowRoot.querySelector("#honey").querySelectorAll("span"),function(span){return"Coupon codes"===span.innerHTML})}function savingsLoaded(){var result=void 0;return _lodash2["default"].forEach(savingsModalParsers,function(parser){var found=parser();if(_lodash2["default"].has(found,"savings"))return void(result=found)}),result}Object.defineProperty(exports,"__esModule",{value:!0});var _regenerator=__webpack_require__(57),_regenerator2=_interopRequireDefault(_regenerator),_asyncToGenerator2=__webpack_require__(84),_asyncToGenerator3=_interopRequireDefault(_asyncToGenerator2),initHoneyChecking=function(){var _ref=(0,_asyncToGenerator3["default"])(_regenerator2["default"].mark(function _callee(){var honeyIsRunning;return _regenerator2["default"].wrap(function(_context){for(;;)switch(_context.prev=_context.next){case 0:return _context.prev=0,_context.next=3,(0,_honeyStateCache2["default"])({action:"getHoneyState"});case 3:honeyIsRunning=_context.sent,honeyIsRunning&&checkUntilTimeout(savingsLoaded,4e4,500,handleHoneySavings),waitForSelector(popupLoaded,function(customEl){addTryCouponsEvtListener();var changeVisibility=_lodash2["default"].debounce(function(visible){(0,_sendMetric2["default"])("track",visible?"showHoney":"hideHoney",{domain:getDomain(),pagePath:location.pathname,url:location.href})},1e3),observer=new MutationObserver(function(mutations){_lodash2["default"].forEach(mutations,function(mutationRecord){var visibility=_lodash2["default"].get(mutationRecord,"target.style.visibility");"hidden"===visibility?changeVisibility(!1):"initial"===visibility&&changeVisibility(!0)})}),target=customEl?customEl.shadowRoot.querySelector("#honey"):null;target&&observer.observe(target,{attributes:!0,attributeFilter:["style"]})}),_context.next=10;break;case 8:_context.prev=8,_context.t0=_context["catch"](0);case 10:case"end":return _context.stop()}},_callee,this,[[0,8]])}));return function(){return _ref.apply(this,arguments)}}(),checkUntilTimeout=function(){var _ref2=(0,_asyncToGenerator3["default"])(_regenerator2["default"].mark(function _callee2(check,timeout,interval,cb){var timeoutID,result;return _regenerator2["default"].wrap(function(_context2){for(;;)switch(_context2.prev=_context2.next){case 0:timeoutID=setTimeout(cb,timeout),result=check();case 2:if(result){_context2.next=8;break}return _context2.next=5,delay(interval);case 5:result=check(),_context2.next=2;break;case 8:clearTimeout(timeoutID),cb(result);case 10:case"end":return _context2.stop()}},_callee2,this)}));return function(_x,_x2,_x3,_x4){return _ref2.apply(this,arguments)}}(),initEbatesChecking=function(){var _ref3=(0,_asyncToGenerator3["default"])(_regenerator2["default"].mark(function _callee3(){var honeyIsRunning;return _regenerator2["default"].wrap(function(_context3){for(;;)switch(_context3.prev=_context3.next){case 0:return _context3.next=2,(0,_honeyStateCache2["default"])({action:"getHoneyState"});case 2:honeyIsRunning=_context3.sent,honeyIsRunning||waitForSelector(ebatesLoaded,function(ebates){(0,_sendMetric2["default"])("track","ebatesNotif",{domain:getDomain(),pagePath:location.pathname,url:location.href}),ebates.querySelector(".ebates-notification-button.ebates-notification-button-activate").addEventListener("click",function(){(0,_sendMetric2["default"])("track","ebatesActivate",{domain:getDomain(),pagePath:location.pathname,url:location.href})}),ebates.querySelector(".ebates-notification-close").addEventListener("click",function(){(0,_sendMetric2["default"])("track","ebatesDismiss",{domain:getDomain(),pagePath:location.pathname,url:location.href})})});case 4:case"end":return _context3.stop()}},_callee3,this)}));return function(){return _ref3.apply(this,arguments)}}(),_lodash=__webpack_require__(143),_lodash2=_interopRequireDefault(_lodash),_sendMetric=__webpack_require__(134),_sendMetric2=_interopRequireDefault(_sendMetric),_bluebird=__webpack_require__(148),_bluebird2=_interopRequireDefault(_bluebird),_honeyStateCache=__webpack_require__(839),_honeyStateCache2=_interopRequireDefault(_honeyStateCache),_state=__webpack_require__(141),_state2=_interopRequireDefault(_state),_shopify=__webpack_require__(840),_shopify2=_interopRequireDefault(_shopify),_backoff=__webpack_require__(783),currentDomain=void 0;exports["default"]=function(domain){currentDomain=domain,initHoneyChecking(),initEbatesChecking()};var savingsModalParsers=[function(){try{var savedRe=/Honey saved you \$([\d\.]+)!/,savings=_lodash2["default"].find(document.querySelector("#honeyContainer").shadowRoot.querySelector("#honey").querySelectorAll("div"),function(div){return savedRe.test(div.innerHTML)}).innerHTML.match(savedRe)[1].replace(".","");if(savings){var originalPrice=document.querySelector("#honeyContainer").shadowRoot.querySelector("#honey").querySelector("strike").innerHTML.replace(".","").replace("$","").replace(",","");return{savings:savings,originalPrice:originalPrice}}}catch(e){return!1}},function(){try{var savedRe=/\$([\d\.]+) saved!/,savings=_lodash2["default"].last(_lodash2["default"].filter(document.querySelector("#honeyContainer").shadowRoot.querySelector("#honey").querySelectorAll("div"),function(div){return savedRe.test(div.innerText)})).innerText.match(savedRe)[1].replace(".","").replace("$","").replace(",","");if(savings){var spans=document.querySelector("#honeyContainer").shadowRoot.querySelector("#honey").querySelectorAll("span"),textIdx=_lodash2["default"].findIndex(spans,function(span){return/original\stotal/i.test(span.innerText)}),originalPrice=spans[textIdx+1].innerText.replace(".","").replace("$","").replace(",","");return{savings:savings,originalPrice:originalPrice}}}catch(e){return!1}},function(){try{return!!/doesn't have working codes/.test(document.querySelector("#honeyContainer").shadowRoot.innerHTML)&&{savings:0,originalPrice:1}}catch(e){return!1}},function(){try{var savedRe=/(You saved).*(\$-)(\d+\.\d+)/,savings=document.querySelector("#honeyContainer").shadowRoot.innerHTML.match(savedRe)[3];if(savings){var originalPriceRe=/(Without Honey)[^\$]+\$(\d+\.\d+)/,originalPrice=document.querySelector("#honeyContainer").shadowRoot.innerHTML.match(originalPriceRe)[2];return{savings:savings,originalPrice:originalPrice}}}catch(e){return!1}}]},839:function(module,exports,__webpack_require__){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{"default":obj}}Object.defineProperty(exports,"__esModule",{value:!0});var _messenger=__webpack_require__(135),_messenger2=_interopRequireDefault(_messenger);exports["default"]=function(data){return(0,_messenger2["default"])("honeyStateCache",data)}},841:function(module,exports,__webpack_require__){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{"default":obj}}Object.defineProperty(exports,"__esModule",{value:!0});var _regenerator=__webpack_require__(57),_regenerator2=_interopRequireDefault(_regenerator),_asyncToGenerator2=__webpack_require__(84),_asyncToGenerator3=_interopRequireDefault(_asyncToGenerator2),_lodash=__webpack_require__(143),_lodash2=_interopRequireDefault(_lodash);exports["default"]=function(){function fetchJSON(_x){return _ref.apply(this,arguments)}var _ref=(0,_asyncToGenerator3["default"])(_regenerator2["default"].mark(function _callee(url){var resp,json,options=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return _regenerator2["default"].wrap(function(_context){for(;;)switch(_context.prev=_context.next){case 0:return _context.next=2,fetch(url,_lodash2["default"].merge({headers:{"Content-Type":"application/json","x-wb-cookie":"test"}},options));case 2:return resp=_context.sent,_context.next=5,resp.json();case 5:if(json=_context.sent,resp.ok){_context.next=8;break}throw new Error(json);case 8:return _context.abrupt("return",json);case 9:case"end":return _context.stop()}},_callee,this)}));return fetchJSON}()},842:function(module,exports,__webpack_require__){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{"default":obj}}Object.defineProperty(exports,"__esModule",{value:!0}),exports.waitForApps=exports.appLoaded=exports.getLoadingApps=void 0;var _regenerator=__webpack_require__(57),_regenerator2=_interopRequireDefault(_regenerator),_asyncToGenerator2=__webpack_require__(84),_asyncToGenerator3=_interopRequireDefault(_asyncToGenerator2),_set=__webpack_require__(17),_set2=_interopRequireDefault(_set),getLoadingApps=exports.getLoadingApps=function(){var _ref=(0,_asyncToGenerator3["default"])(_regenerator2["default"].mark(function _callee(){return _regenerator2["default"].wrap(function(_context){for(;;)switch(_context.prev=_context.next){case 0:if(fetched){_context.next=7;break}return _context.t0=_set2["default"],_context.next=4,(0,_fetchLoadingApps2["default"])();case 4:_context.t1=_context.sent,loadingApps=new _context.t0(_context.t1),fetched=!0;case 7:return _context.abrupt("return",loadingApps);case 8:case"end":return _context.stop()}},_callee,this)}));return function(){return _ref.apply(this,arguments)}}(),_fetchLoadingApps=(exports.appLoaded=function(){var _ref2=(0,_asyncToGenerator3["default"])(_regenerator2["default"].mark(function _callee2(app){return _regenerator2["default"].wrap(function(_context2){for(;;)switch(_context2.prev=_context2.next){case 0:loadingApps["delete"](app);case 1:case"end":return _context2.stop()}},_callee2,this)}));return function(_x){return _ref2.apply(this,arguments)}}(),exports.waitForApps=function(){var _ref3=(0,_asyncToGenerator3["default"])(_regenerator2["default"].mark(function _callee4(apps){var _this=this;return _regenerator2["default"].wrap(function(_context4){for(;;)switch(_context4.prev=_context4.next){case 0:return _context4.next=2,_bluebird2["default"].map(apps,function(){var _ref4=(0,_asyncToGenerator3["default"])(_regenerator2["default"].mark(function _callee3(app){var loadingApps;return _regenerator2["default"].wrap(function(_context3){for(;;)switch(_context3.prev=_context3.next){case 0:return _context3.next=2,getLoadingApps();case 2:loadingApps=_context3.sent;case 3:if(!loadingApps.has(app)){_context3.next=11;break}return _context3.next=6,(0,_delay2["default"])(50);case 6:return _context3.next=8,getLoadingApps();case 8:loadingApps=_context3.sent,_context3.next=3;break;case 11:case"end":return _context3.stop()}},_callee3,_this)}));return function(_x3){return _ref4.apply(this,arguments)}}());case 2:case"end":return _context4.stop()}},_callee4,this)}));return function(_x2){return _ref3.apply(this,arguments)}}(),__webpack_require__(843)),_fetchLoadingApps2=_interopRequireDefault(_fetchLoadingApps),_delay=__webpack_require__(147),_delay2=_interopRequireDefault(_delay),_bluebird=__webpack_require__(148),_bluebird2=_interopRequireDefault(_bluebird),fetched=!1,loadingApps=new _set2["default"]([])},843:function(module,exports,__webpack_require__){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{"default":obj}}Object.defineProperty(exports,"__esModule",{value:!0});var _messenger=__webpack_require__(135),_messenger2=_interopRequireDefault(_messenger);exports["default"]=function(){return(0,_messenger2["default"])("fetchLoadingApps")}}});