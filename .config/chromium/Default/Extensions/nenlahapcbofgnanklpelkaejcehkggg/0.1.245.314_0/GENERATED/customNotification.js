webpackJsonp([3],{0:function(module,exports,__webpack_require__){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{"default":obj}}function checkValue(identifier){return"url"===identifier.type?!!document.URL.match(identifier.value):"title"===identifier.type?document.title.match(identifier.value):"selector"===identifier.type?!!(0,_jquery2["default"])(identifier.value).length:void 0}function evaluate(identifiers){if(identifiers.and){var count=(0,_lodash2["default"])(identifiers.and).map(function(identifier){return checkValue(identifier)}).filter().value().length;return count===identifiers.and.length}if(identifiers.or){var _count=(0,_lodash2["default"])(identifiers.or).map(function(identifier){return checkValue(identifier)}).filter().value().length;return!!_count}}function checkNotifications(notifications){return _lodash2["default"].find(notifications,function(n){return evaluate(n.identifiers)})}function checkRunWithCoupons(siteData,notification){if(_lodash2["default"].has(notification,"runWithCoupons")){var runningCoupons=!_lodash2["default"].get(siteData,"coupons.ignoreSite");return!((!runningCoupons||notification.runWithCoupons===!1)&&runningCoupons)}return!0}var _regenerator=__webpack_require__(57),_regenerator2=_interopRequireDefault(_regenerator),_asyncToGenerator2=__webpack_require__(84),_asyncToGenerator3=_interopRequireDefault(_asyncToGenerator2),init=function(){var _ref=(0,_asyncToGenerator3["default"])(_regenerator2["default"].mark(function _callee(){var domain,custom,_ref2,siteData,notifications,notificationPage;return _regenerator2["default"].wrap(function(_context){for(;;)switch(_context.prev=_context.next){case 0:return _context.prev=0,domain=(0,_currentDomain2["default"])(),_context.next=4,(0,_getCustomNotification2["default"])();case 4:if(custom=_context.sent,!custom||!custom.engaged){_context.next=7;break}return _context.abrupt("return",!1);case 7:return _context.next=9,(0,_siteCache2["default"])(domain);case 9:_ref2=_context.sent,siteData=_ref2.siteData,notifications=_lodash2["default"].filter(siteData.notifications,function(n){return n.enabled!==!1&&checkRunWithCoupons(siteData,n)}),notificationPage=checkNotifications(notifications),notificationPage&&notifications.length&&(_state2["default"].set("customNotificationData",notifications),(0,_loadApp2["default"])({initialRoute:"/customNotification",cssUrl:"GENERATED/customNotification.css",route:_react2["default"].createElement(_reactRouter.Route,{path:"customNotification",component:_CustomNotification2["default"]})})),_context.next=18;break;case 16:_context.prev=16,_context.t0=_context["catch"](0);case 18:case"end":return _context.stop()}},_callee,this,[[0,16]])}));return function(){return _ref.apply(this,arguments)}}(),_lodash=__webpack_require__(143),_lodash2=_interopRequireDefault(_lodash),_react=__webpack_require__(85),_react2=_interopRequireDefault(_react),_CustomNotification=__webpack_require__(864),_CustomNotification2=_interopRequireDefault(_CustomNotification),_reactRouter=__webpack_require__(317),_loadApp=__webpack_require__(375),_loadApp2=_interopRequireDefault(_loadApp),_siteCache=__webpack_require__(475),_siteCache2=_interopRequireDefault(_siteCache),_currentDomain=__webpack_require__(429),_currentDomain2=_interopRequireDefault(_currentDomain),_getCustomNotification=__webpack_require__(868),_getCustomNotification2=_interopRequireDefault(_getCustomNotification),_state=__webpack_require__(141),_state2=_interopRequireDefault(_state),_jquery=__webpack_require__(460),_jquery2=_interopRequireDefault(_jquery);"loading"!==document.readyState?init():document.addEventListener("DOMContentLoaded",init)},864:function(module,exports,__webpack_require__){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{"default":obj}}Object.defineProperty(exports,"__esModule",{value:!0});var _extends2=__webpack_require__(1),_extends3=_interopRequireDefault(_extends2),_getPrototypeOf=__webpack_require__(91),_getPrototypeOf2=_interopRequireDefault(_getPrototypeOf),_classCallCheck2=__webpack_require__(95),_classCallCheck3=_interopRequireDefault(_classCallCheck2),_createClass2=__webpack_require__(96),_createClass3=_interopRequireDefault(_createClass2),_possibleConstructorReturn2=__webpack_require__(99),_possibleConstructorReturn3=_interopRequireDefault(_possibleConstructorReturn2),_inherits2=__webpack_require__(101),_inherits3=_interopRequireDefault(_inherits2),_react=__webpack_require__(85),_react2=_interopRequireDefault(_react),_nodeUuid=__webpack_require__(389),_nodeUuid2=_interopRequireDefault(_nodeUuid),_reactMotion=__webpack_require__(102),_baobab=__webpack_require__(121),_customNotificationActions=__webpack_require__(865),_sendMetric=__webpack_require__(134),_sendMetric2=_interopRequireDefault(_sendMetric),_couponActions=__webpack_require__(649),_lodash=__webpack_require__(143),_lodash2=_interopRequireDefault(_lodash),_ProgressBar=__webpack_require__(829),_ProgressBar2=_interopRequireDefault(_ProgressBar),_currentDomain=__webpack_require__(429),_currentDomain2=_interopRequireDefault(_currentDomain);__webpack_require__(867);var CustomNotification=function(_Component){function CustomNotification(){var _ref;(0,_classCallCheck3["default"])(this,CustomNotification);for(var _len=arguments.length,args=Array(_len),_key=0;_key<_len;_key++)args[_key]=arguments[_key];var _this=(0,_possibleConstructorReturn3["default"])(this,(_ref=CustomNotification.__proto__||(0,_getPrototypeOf2["default"])(CustomNotification)).call.apply(_ref,[this].concat(args))),display=void 0,displaySequence=_lodash2["default"].get(_lodash2["default"].find(_this.props.customNotificationData,"displaySequence"),"displaySequence",[]);return display=displaySequence.length?displaySequence[0]:_this.props.customNotificationData[0].display,_this.state=(0,_extends3["default"])({notification:0,hideNotification:!0,dismiss:!1,progress:!1,displaySequence:displaySequence},display),_this}return(0,_inherits3["default"])(CustomNotification,_Component),(0,_createClass3["default"])(CustomNotification,[{key:"componentDidMount",value:function(){var _this2=this;(0,_sendMetric2["default"])("page","customNotification",{view:"customNotification",type:"notification",domain:location.hostname.replace(/^www\./,""),pagePath:location.pathname,offerSignUp:_lodash2["default"].get(this.props.view,"offerSignUp"),qualified:_lodash2["default"].get(this.props.view,"qualified",!1),balance:_lodash2["default"].get(this.props.view,"balance",0)}),setTimeout(function(){_this2.setState({hideNotification:!1})},1e3)}},{key:"render",value:function(){var _this3=this,hideNotification=this.state.hideNotification,showOnTop=!0,showOnRight=!0,content=void 0;return this.state.cta&&(content=_react2["default"].createElement("div",{className:"button-wrapper"},_react2["default"].createElement("button",{className:"primary-btn-large",onClick:this.onClick.bind(this)},this.state.cta))),_react2["default"].createElement("div",{className:hideNotification?"disabled follow-page":"follow-page",style:{top:showOnTop?"0":"auto",bottom:showOnTop?"auto":"0",left:showOnRight?"auto":"0",right:showOnRight?"0":"auto"}},_react2["default"].createElement(_reactMotion.Motion,{style:{opacity:(0,_reactMotion.spring)(hideNotification?0:1,{stiffness:180,damping:20}),y:(0,_reactMotion.spring)(hideNotification?showOnTop?-100:100:0,{stiffness:180,damping:20})}},function(_ref2){var opacity=_ref2.opacity,y=_ref2.y;return _react2["default"].createElement("div",{className:"custom-notification",style:{transform:"translate3d(0,"+y+"%,0)",opacity:""+opacity}},_react2["default"].createElement("header",null,_react2["default"].createElement("div",{className:"w-icon-logo"},_this3.renderWIcon()),_react2["default"].createElement("div",{className:"close icon-x",onClick:_this3.onClosePopup.bind(_this3,"x")})),_react2["default"].createElement("section",null,_react2["default"].createElement("h2",null,_this3.state.title),_this3.state.progress?_react2["default"].createElement(_ProgressBar2["default"],{estimatedDuration:5e3}):null,_this3.state.subtitle?_react2["default"].createElement("h4",{className:"bold"},_this3.state.subtitle):null,content))}))}},{key:"onClick",value:function(){var _this4=this,clickID=_nodeUuid2["default"].v4().replace(/-/,"");if(this.state.dropCookie&&(0,_couponActions.dropCookie)(clickID),this.state.sendMetric&&(0,_sendMetric2["default"])("track","noCouponsNotify",{clickID:clickID,currentLocation:window.location.href,domain:(0,_currentDomain2["default"])()}),this.state.notification<this.state.displaySequence.length-1){var iterator=this.state.notification+1,display=this.state.displaySequence[iterator],setNextDisplay=function(){_this4.setState((0,_extends3["default"])({notification:iterator},display)),_this4.state.timeout&&void 0===display.timeout&&_this4.setState({timeout:void 0}),iterator===_this4.state.displaySequence.length-1&&display.timeout&&setTimeout(function(){_this4.onClosePopup()},_this4.state.timeout)};this.setState({progress:!!this.state.timeout}),setTimeout(function(){setNextDisplay(),_this4.setState({progress:!1})},2*this.state.timeout||0)}else if(this.props.customNotificationData.url){(0,_customNotificationActions.engage)();var clickId=_nodeUuid2["default"].v4().replace(/-/g,""),url=("https://api.wikibuy.com/v1/redirect?r=true&url="+encodeURIComponent(this.props.customNotificationData.url)+"&clickId=mock_click_id").replace("mock_click_id",clickId);window.open(url,"_blank"),(0,_sendMetric2["default"])("trackClick","customNotificationClick","",{view:"customNotification",domain:location.hostname.replace(/^www\./,""),pagePath:location.pathname,pageLocation:"notification",clickId:clickId})}else setTimeout(function(){_this4.onClosePopup()},this.state.timeout||0)}},{key:"onClosePopup",value:function(label){(0,_customNotificationActions.engage)(),this.setState({hideNotification:!0}),(0,_sendMetric2["default"])("trackClick","dismissCustomNotification",label,{domain:location.hostname.replace(/^www\./,""),pagePath:location.pathname})}},{key:"renderWIcon",value:function(){return _react2["default"].createElement("svg",{id:"Layer_1",x:"0px",y:"0px",viewBox:"0 0 60 45"},_react2["default"].createElement("g",null,_react2["default"].createElement("path",{d:"M39.4,35.9h-9L25,19.1h-0.1l-5.2,16.8h-9L1.3,8.8h9.6L15.7,26h0.1l4.9-17.2h8.9l5,17.2h0.1l4.8-17.2h9.3 L39.4,35.9z M57.7,31.6c0,0.7-0.1,1.4-0.4,2c-0.2,0.6-0.6,1.1-1,1.6c-0.4,0.4-1,0.8-1.7,1s-1.3,0.3-2,0.3c-1.5,0-2.7-0.5-3.7-1.4 c-1-0.9-1.4-2-1.4-3.5c0-0.7,0.1-1.3,0.4-1.8c0.2-0.7,0.6-1.3,1-1.6c0.8-0.7,1.4-1,1.7-1.1c0.9-0.3,1.6-0.4,2-0.4 c0.7,0,1.4,0.1,2,0.4c0.7,0.2,1.2,0.6,1.7,1c0.3,0.3,0.7,0.8,1.1,1.6C57.6,30.2,57.7,30.8,57.7,31.6z"})))}}]),CustomNotification}(_react.Component);exports["default"]=(0,_baobab.branch)({view:["customView"],customNotificationData:["customNotificationData"],events:["events"],session:["session"]},CustomNotification)},865:function(module,exports,__webpack_require__){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{"default":obj}}function engage(){(0,_engageCustomNotification2["default"])()}Object.defineProperty(exports,"__esModule",{value:!0}),exports.engage=engage;var _engageCustomNotification=__webpack_require__(866),_engageCustomNotification2=_interopRequireDefault(_engageCustomNotification)},866:function(module,exports,__webpack_require__){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{"default":obj}}Object.defineProperty(exports,"__esModule",{value:!0});var _messenger=__webpack_require__(135),_messenger2=_interopRequireDefault(_messenger);exports["default"]=function(data){return(0,_messenger2["default"])("engageCustomNotification",data)}},867:196,868:function(module,exports,__webpack_require__){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{"default":obj}}Object.defineProperty(exports,"__esModule",{value:!0});var _messenger=__webpack_require__(135),_messenger2=_interopRequireDefault(_messenger);exports["default"]=function(){return(0,_messenger2["default"])("getCustomNotification")}}});